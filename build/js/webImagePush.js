(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

window.onload = function () {
    // canvasエレメントを取得
    var c = document.getElementById('canvas');
    c.width = 500;
    c.height = 300;
    // webglコンテキストを取得
    var gl = c.getContext('webgl') || c.getContext('experimental-webgl');
    console.log(gl);
    // 頂点シェーダとフラグメントシェーダの生成
    var v_shader = create_shader(gl, 'vs');
    var f_shader = create_shader(gl, 'fs');

    // プログラムオブジェクトの生成とリンク
    var prg = create_program(gl, v_shader, f_shader);

    // attributeLocationを配列に取得
    var attLocation = new Array();
    attLocation[0] = gl.getAttribLocation(prg, 'position');
    attLocation[1] = gl.getAttribLocation(prg, 'color');
    attLocation[2] = gl.getAttribLocation(prg, 'textureCoord');

    // attributeの要素数を配列に格納
    var attStride = new Array();
    attStride[0] = 3;
    attStride[1] = 4;
    attStride[2] = 2;

    // 頂点の位置
    var position = [-1.0, 1.0, 0.0, 1.0, 1.0, 0.0, -1.0, -1.0, 0.0, 1.0, -1.0, 0.0];

    // 頂点色
    var color = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0];

    // テクスチャ座標
    var textureCoord = [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0];

    // 頂点インデックス
    var index = [0, 1, 2, 3, 2, 1];

    // VBOとIBOの生成
    var vPosition = create_vbo(gl, position);
    var vColor = create_vbo(gl, color);
    var vTextureCoord = create_vbo(gl, textureCoord);
    var VBOList = [vPosition, vColor, vTextureCoord];
    var iIndex = create_ibo(gl, index);

    // VBOとIBOの登録
    set_attribute(gl, VBOList, attLocation, attStride);
    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, iIndex);

    // uniformLocationを配列に取得
    var uniLocation = new Array();
    uniLocation[0] = gl.getUniformLocation(prg, 'mvpMatrix');
    uniLocation[1] = gl.getUniformLocation(prg, 'texture');

    // 各種行列の生成と初期化
    var m = new matIV();
    var mMatrix = m.identity(m.create());
    var vMatrix = m.identity(m.create());
    var pMatrix = m.identity(m.create());
    var tmpMatrix = m.identity(m.create());
    var mvpMatrix = m.identity(m.create());

    // ビュー×プロジェクション座標変換行列
    m.lookAt([0.0, 2.0, 5.0], [0, 0, 0], [0, 1, 0], vMatrix);
    m.perspective(45, c.width / c.height, 0.1, 100, pMatrix);
    m.multiply(pMatrix, vMatrix, tmpMatrix);

    // 深度テストを有効にする
    gl.enable(gl.DEPTH_TEST);
    gl.depthFunc(gl.LEQUAL);

    // 有効にするテクスチャユニットを指定
    gl.activeTexture(gl.TEXTURE0);

    // テクスチャ用変数の宣言
    var texture = new Array();
    //texture[0] = null;

    var posZ = new Array();
    //テクスチャ呼ばれたら
    var socket = io();

    //socketのイベントが何回きたかしらべる
    var getnumber = 0;
    //サーバーからデータを受け取る

    socket.on("pushImageFromServer", function (data) {
        //    var image = document.getElementById("image");
        create_texture(gl, data, getnumber);
        posZ[getnumber] = -105;
        getnumber++;
        console.log(getnumber);
        console.log(texture);
    });

    // テクスチャを生成
    //create_texture(gl,"../img/test.jpg",0);
    //create_texture(gl,img_data);
    // カウンタの宣言
    var count = 0;
    var count2 = 0;
    // 恒常ループ
    (function loop() {
        // canvasを初期化
        //        gl.clearColor(0.0, 0.0, 0.0, 1.0);
        var hsv = hsva(count2 % 360, 1, 1, 1);
        gl.clearColor(hsv[0], hsv[1], hsv[2], hsv[3]);
        gl.clearDepth(1.0);
        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);

        // カウンタを元にラジアンを算出
        count++;
        if (count % 10 == 0) {
            count2++;
        }
        var rad = count % 360 * Math.PI / 180;

        //  // モデル座標変換行列の生成
        //  m.identity(mMatrix);
        //  m.rotate(mMatrix, rad, [0, 1, 0], mMatrix);
        //  m.multiply(tmpMatrix, mMatrix, mvpMatrix);

        //  // テクスチャをバインドする
        //  gl.bindTexture(gl.TEXTURE_2D, texture[0]);

        //  // uniform変数にテクスチャを登録
        // gl.uniform1i(uniLocation[1], 0);

        //  // uniform変数の登録と描画
        //  gl.uniformMatrix4fv(uniLocation[0], false, mvpMatrix);
        //  gl.drawElements(gl.TRIANGLES, index.length, gl.UNSIGNED_SHORT, 0);
        if (texture) {
            for (var i = 0; i < texture.length; i++) {
                if (posZ[i] == 7) {
                    texture.shift();
                    posZ.shift();
                }
            }
            for (var i = 0; i < texture.length; i++) {
                posZ[i] += 0.5;
                bindPlatePoly(gl, m, mMatrix, rad, tmpMatrix, mvpMatrix, uniLocation, index, i, posZ[i]);
            }
        }
        // コンテキストの再描画
        gl.flush();

        // ループのために再帰呼び出し
        //setTimeout(loop, 1000 / 30);
        requestAnimationFrame(loop);
    })();

    function bindPlatePoly(_gl, _m, _mMatrix, _rad, _tmpMatrix, _mvpMatrix, _uniLocation, _index, _number, _posZ) {
        // モデル座標変換行列の生成
        _m.identity(_mMatrix);
        _m.translate(_mMatrix, [0, 0, _posZ], _mMatrix);
        _m.rotate(_mMatrix, _rad, [0, 1, 0], _mMatrix);
        _m.multiply(_tmpMatrix, _mMatrix, _mvpMatrix);

        // テクスチャをバインドする
        _gl.bindTexture(_gl.TEXTURE_2D, texture[_number]);

        // uniform変数にテクスチャを登録
        _gl.uniform1i(_uniLocation[1], 0);

        // uniform変数の登録と描画
        _gl.uniformMatrix4fv(_uniLocation[0], false, _mvpMatrix);
        _gl.drawElements(_gl.TRIANGLES, _index.length, _gl.UNSIGNED_SHORT, 0);
    }
    // テクスチャを生成する関数
    function create_texture(_gl, _source, _n) {
        // イメージオブジェクトの生成
        var img = new Image();

        // データのオンロードをトリガーにする
        img.onload = function () {
            // テクスチャオブジェクトの生成
            var tex = _gl.createTexture();

            // テクスチャをバインドする
            _gl.bindTexture(_gl.TEXTURE_2D, tex);

            // テクスチャへイメージを適用
            _gl.texImage2D(_gl.TEXTURE_2D, 0, _gl.RGBA, _gl.RGBA, _gl.UNSIGNED_BYTE, img);
            _gl.texParameteri(_gl.TEXTURE_2D, _gl.TEXTURE_MAG_FILTER, _gl.LINEAR);
            _gl.texParameteri(_gl.TEXTURE_2D, _gl.TEXTURE_MIN_FILTER, _gl.LINEAR);
            _gl.texParameteri(_gl.TEXTURE_2D, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE);
            _gl.texParameteri(_gl.TEXTURE_2D, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE);

            // ミップマップを生成
            _gl.generateMipmap(_gl.TEXTURE_2D);

            // テクスチャのバインドを無効化
            _gl.bindTexture(_gl.TEXTURE_2D, null);

            // 生成したテクスチャをグローバル変数に代入
            texture[_n] = tex;
        };

        // イメージオブジェクトのソースを指定
        img.src = _source;
    }
};

// シェーダを生成する関数
function create_shader(_gl, _id) {
    // シェーダを格納する変数
    var shader;

    // HTMLからscriptタグへの参照を取得
    var scriptElement = document.getElementById(_id);

    // scriptタグが存在しない場合は抜ける
    if (!scriptElement) {
        return;
    }

    // scriptタグのtype属性をチェック
    switch (scriptElement.type) {

        // 頂点シェーダの場合
        case 'x-shader/x-vertex':
            shader = _gl.createShader(_gl.VERTEX_SHADER);
            break;

        // フラグメントシェーダの場合
        case 'x-shader/x-fragment':
            shader = _gl.createShader(_gl.FRAGMENT_SHADER);
            break;
        default:
            return;
    }

    // 生成されたシェーダにソースを割り当てる
    _gl.shaderSource(shader, scriptElement.text);

    // シェーダをコンパイルする
    _gl.compileShader(shader);

    // シェーダが正しくコンパイルされたかチェック
    if (_gl.getShaderParameter(shader, _gl.COMPILE_STATUS)) {

        // 成功していたらシェーダを返して終了
        return shader;
    } else {

        // 失敗していたらエラーログをアラートする
        alert(_gl.getShaderInfoLog(shader));
    }
}
// プログラムオブジェクトを生成しシェーダをリンクする関数
function create_program(_gl, _vs, _fs) {
    // プログラムオブジェクトの生成
    var program = _gl.createProgram();

    // プログラムオブジェクトにシェーダを割り当てる
    _gl.attachShader(program, _vs);
    _gl.attachShader(program, _fs);

    // シェーダをリンク
    _gl.linkProgram(program);

    // シェーダのリンクが正しく行なわれたかチェック
    if (_gl.getProgramParameter(program, _gl.LINK_STATUS)) {

        // 成功していたらプログラムオブジェクトを有効にする
        _gl.useProgram(program);

        // プログラムオブジェクトを返して終了
        return program;
    } else {

        // 失敗していたらエラーログをアラートする
        alert(_gl.getProgramInfoLog(program));
    }
}
// VBOを生成する関数
function create_vbo(_gl, _data) {
    // バッファオブジェクトの生成
    var vbo = _gl.createBuffer();

    // バッファをバインドする
    _gl.bindBuffer(_gl.ARRAY_BUFFER, vbo);

    // バッファにデータをセット
    _gl.bufferData(_gl.ARRAY_BUFFER, new Float32Array(_data), _gl.STATIC_DRAW);

    // バッファのバインドを無効化
    _gl.bindBuffer(_gl.ARRAY_BUFFER, null);

    // 生成した VBO を返して終了
    return vbo;
}
// VBOをバインドし登録する関数
function set_attribute(_gl, _vbo, _attL, _attS) {
    // 引数として受け取った配列を処理する
    for (var i in _vbo) {
        // バッファをバインドする
        _gl.bindBuffer(_gl.ARRAY_BUFFER, _vbo[i]);

        // attributeLocationを有効にする
        _gl.enableVertexAttribArray(_attL[i]);

        // attributeLocationを通知し登録する
        _gl.vertexAttribPointer(_attL[i], _attS[i], _gl.FLOAT, false, 0, 0);
    }
}
// IBOを生成する関数
function create_ibo(_gl, _data) {
    // バッファオブジェクトの生成
    var ibo = _gl.createBuffer();

    // バッファをバインドする
    _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, ibo);

    // バッファにデータをセット
    _gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER, new Int16Array(_data), _gl.STATIC_DRAW);

    // バッファのバインドを無効化
    _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, null);

    // 生成したIBOを返して終了
    return ibo;
}

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmNcXGpzXFx3ZWJJbWFnZVB1c2guanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLE9BQU8sTUFBUCxHQUFjLFlBQVU7QUFDcEI7QUFDQSxRQUFJLElBQUksU0FBUyxjQUFULENBQXdCLFFBQXhCLENBQVI7QUFDQSxNQUFFLEtBQUYsR0FBVSxHQUFWO0FBQ0EsTUFBRSxNQUFGLEdBQVcsR0FBWDtBQUNBO0FBQ0EsUUFBSSxLQUFLLEVBQUUsVUFBRixDQUFhLE9BQWIsS0FBeUIsRUFBRSxVQUFGLENBQWEsb0JBQWIsQ0FBbEM7QUFDQSxZQUFRLEdBQVIsQ0FBWSxFQUFaO0FBQ0E7QUFDQSxRQUFJLFdBQVcsY0FBYyxFQUFkLEVBQWlCLElBQWpCLENBQWY7QUFDQSxRQUFJLFdBQVcsY0FBYyxFQUFkLEVBQWlCLElBQWpCLENBQWY7O0FBRUE7QUFDQSxRQUFJLE1BQU0sZUFBZSxFQUFmLEVBQWtCLFFBQWxCLEVBQTRCLFFBQTVCLENBQVY7O0FBRUE7QUFDQSxRQUFJLGNBQWMsSUFBSSxLQUFKLEVBQWxCO0FBQ0EsZ0JBQVksQ0FBWixJQUFpQixHQUFHLGlCQUFILENBQXFCLEdBQXJCLEVBQTBCLFVBQTFCLENBQWpCO0FBQ0EsZ0JBQVksQ0FBWixJQUFpQixHQUFHLGlCQUFILENBQXFCLEdBQXJCLEVBQTBCLE9BQTFCLENBQWpCO0FBQ0EsZ0JBQVksQ0FBWixJQUFpQixHQUFHLGlCQUFILENBQXFCLEdBQXJCLEVBQTBCLGNBQTFCLENBQWpCOztBQUVBO0FBQ0EsUUFBSSxZQUFZLElBQUksS0FBSixFQUFoQjtBQUNBLGNBQVUsQ0FBVixJQUFlLENBQWY7QUFDQSxjQUFVLENBQVYsSUFBZSxDQUFmO0FBQ0EsY0FBVSxDQUFWLElBQWUsQ0FBZjs7QUFFQTtBQUNBLFFBQUksV0FBVyxDQUNYLENBQUMsR0FEVSxFQUNKLEdBREks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QUFJLFVBQUosQ0FBZSxJQUFJLG9CQUFuQixFQUF5QyxJQUF6Qzs7QUFFQTtBQUNBLFdBQU8sR0FBUDtBQUNIIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIndpbmRvdy5vbmxvYWQ9ZnVuY3Rpb24oKXtcclxuICAgIC8vIGNhbnZhc+OCqOODrOODoeODs+ODiOOCkuWPluW+l1xyXG4gICAgdmFyIGMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7XHJcbiAgICBjLndpZHRoID0gNTAwO1xyXG4gICAgYy5oZWlnaHQgPSAzMDA7XHJcbiAgICAvLyB3ZWJnbOOCs+ODs+ODhuOCreOCueODiOOCkuWPluW+l1xyXG4gICAgdmFyIGdsID0gYy5nZXRDb250ZXh0KCd3ZWJnbCcpIHx8IGMuZ2V0Q29udGV4dCgnZXhwZXJpbWVudGFsLXdlYmdsJyk7XHJcbiAgICBjb25zb2xlLmxvZyhnbCk7XHJcbiAgICAvLyDpoILngrnjgrfjgqfjg7zjg4Djgajjg5Xjg6njgrDjg6Hjg7Pjg4jjgrfjgqfjg7zjg4Djga7nlJ/miJBcclxuICAgIHZhciB2X3NoYWRlciA9IGNyZWF0ZV9zaGFkZXIoZ2wsJ3ZzJyk7XHJcbiAgICB2YXIgZl9zaGFkZXIgPSBjcmVhdGVfc2hhZGVyKGdsLCdmcycpO1xyXG4gICAgXHJcbiAgICAvLyDjg5fjg63jgrDjg6njg6Djgqrjg5bjgrjjgqfjgq/jg4jjga7nlJ/miJDjgajjg6rjg7Pjgq9cclxuICAgIHZhciBwcmcgPSBjcmVhdGVfcHJvZ3JhbShnbCx2X3NoYWRlciwgZl9zaGFkZXIpO1xyXG4gICAgXHJcbiAgICAvLyBhdHRyaWJ1dGVMb2NhdGlvbuOCkumFjeWIl+OBq+WPluW+l1xyXG4gICAgdmFyIGF0dExvY2F0aW9uID0gbmV3IEFycmF5KCk7XHJcbiAgICBhdHRMb2NhdGlvblswXSA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKHByZywgJ3Bvc2l0aW9uJyk7XHJcbiAgICBhdHRMb2NhdGlvblsxXSA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKHByZywgJ2NvbG9yJyk7XHJcbiAgICBhdHRMb2NhdGlvblsyXSA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKHByZywgJ3RleHR1cmVDb29yZCcpO1xyXG4gICAgXHJcbiAgICAvLyBhdHRyaWJ1dGXjga7opoHntKDmlbDjgpLphY3liJfjgavmoLzntI1cclxuICAgIHZhciBhdHRTdHJpZGUgPSBuZXcgQXJyYXkoKTtcclxuICAgIGF0dFN0cmlkZVswXSA9IDM7XHJcbiAgICBhdHRTdHJpZGVbMV0gPSA0O1xyXG4gICAgYXR0U3RyaWRlWzJdID0gMjtcclxuICAgIFxyXG4gICAgLy8g6aCC54K544Gu5L2N572uXHJcbiAgICB2YXIgcG9zaXRpb24gPSBbXHJcbiAgICAgICAgLTEuMCwgIDEuMCwgIDAuMCxcclxuICAgICAgICAgMS4wLCAgMS4wLCAgMC4wLFxyXG4gICAgICAgIC0xLjAsIC0xLjAsICAwLjAsXHJcbiAgICAgICAgIDEuMCwgLTEuMCwgIDAuMFxyXG4gICAgXTtcclxuICAgIFxyXG4gICAgLy8g6aCC54K56ImyXHJcbiAgICB2YXIgY29sb3IgPSBbXHJcbiAgICAgICAgMS4wLCAxLjAsIDEuMCwgMS4wLFxyXG4gICAgICAgIDEuMCwgMS4wLCAxLjAsIDEuMCxcclxuICAgICAgICAxLjAsIDEuMCwgMS4wLCAxLjAsXHJcbiAgICAgICAgMS4wLCAxLjAsIDEuMCwgMS4wXHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICAvLyDjg4bjgq/jgrnjg4Hjg6PluqfmqJlcclxuICAgIHZhciB0ZXh0dXJlQ29vcmQgPSBbXHJcbiAgICAgICAgMC4wLCAwLjAsXHJcbiAgICAgICAgMS4wLCAwLjAsXHJcbiAgICAgICAgMC4wLCAxLjAsXHJcbiAgICAgICAgMS4wLCAxLjBcclxuICAgIF07XHJcbiAgICBcclxuICAgIC8vIOmggueCueOCpOODs+ODh+ODg+OCr+OCuVxyXG4gICAgdmFyIGluZGV4ID0gW1xyXG4gICAgICAgIDAsIDEsIDIsXHJcbiAgICAgICAgMywgMiwgMVxyXG4gICAgXTtcclxuICAgIFxyXG4gICAgLy8gVkJP44GoSUJP44Gu55Sf5oiQXHJcbiAgICB2YXIgdlBvc2l0aW9uICAgICA9IGNyZWF0ZV92Ym8oZ2wscG9zaXRpb24pO1xyXG4gICAgdmFyIHZDb2xvciAgICAgICAgPSBjcmVhdGVfdmJvKGdsLGNvbG9yKTtcclxuICAgIHZhciB2VGV4dHVyZUNvb3JkID0gY3JlYXRlX3ZibyhnbCx0ZXh0dXJlQ29vcmQpO1xyXG4gICAgdmFyIFZCT0xpc3QgICAgICAgPSBbdlBvc2l0aW9uLCB2Q29sb3IsIHZUZXh0dXJlQ29vcmRdO1xyXG4gICAgdmFyIGlJbmRleCAgICAgICAgPSBjcmVhdGVfaWJvKGdsLGluZGV4KTtcclxuICAgIFxyXG4gICAgLy8gVkJP44GoSUJP44Gu55m76YyyXHJcbiAgICBzZXRfYXR0cmlidXRlKGdsLFZCT0xpc3QsIGF0dExvY2F0aW9uLCBhdHRTdHJpZGUpO1xyXG4gICAgZ2wuYmluZEJ1ZmZlcihnbC5FTEVNRU5UX0FSUkFZX0JVRkZFUiwgaUluZGV4KTtcclxuICAgIFxyXG4gICAgLy8gdW5pZm9ybUxvY2F0aW9u44KS6YWN5YiX44Gr5Y+W5b6XXHJcbiAgICB2YXIgdW5pTG9jYXRpb24gPSBuZXcgQXJyYXkoKTtcclxuICAgIHVuaUxvY2F0aW9uWzBdICA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcmcsICdtdnBNYXRyaXgnKTtcclxuICAgIHVuaUxvY2F0aW9uWzFdICA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcmcsICd0ZXh0dXJlJyk7XHJcbiAgICBcclxuICAgIC8vIOWQhOeoruihjOWIl+OBrueUn+aIkOOBqOWIneacn+WMllxyXG4gICAgdmFyIG0gPSBuZXcgbWF0SVYoKTtcclxuICAgIHZhciBtTWF0cml4ICAgPSBtLmlkZW50aXR5KG0uY3JlYXRlKCkpO1xyXG4gICAgdmFyIHZNYXRyaXggICA9IG0uaWRlbnRpdHkobS5jcmVhdGUoKSk7XHJcbiAgICB2YXIgcE1hdHJpeCAgID0gbS5pZGVudGl0eShtLmNyZWF0ZSgpKTtcclxuICAgIHZhciB0bXBNYXRyaXggPSBtLmlkZW50aXR5KG0uY3JlYXRlKCkpO1xyXG4gICAgdmFyIG12cE1hdHJpeCA9IG0uaWRlbnRpdHkobS5jcmVhdGUoKSk7XHJcbiAgICBcclxuICAgIC8vIOODk+ODpeODvMOX44OX44Ot44K444Kn44Kv44K344On44Oz5bqn5qiZ5aSJ5o+b6KGM5YiXXHJcbiAgICBtLmxvb2tBdChbMC4wLCAyLjAsIDUuMF0sIFswLCAwLCAwXSwgWzAsIDEsIDBdLCB2TWF0cml4KTtcclxuICAgIG0ucGVyc3BlY3RpdmUoNDUsIGMud2lkdGggLyBjLmhlaWdodCwgMC4xLCAxMDAsIHBNYXRyaXgpO1xyXG4gICAgbS5tdWx0aXBseShwTWF0cml4LCB2TWF0cml4LCB0bXBNYXRyaXgpO1xyXG4gICAgXHJcbiAgICAvLyDmt7Hluqbjg4bjgrnjg4jjgpLmnInlirnjgavjgZnjgotcclxuICAgIGdsLmVuYWJsZShnbC5ERVBUSF9URVNUKTtcclxuICAgIGdsLmRlcHRoRnVuYyhnbC5MRVFVQUwpO1xyXG4gICAgXHJcbiAgICAvLyDmnInlirnjgavjgZnjgovjg4bjgq/jgrnjg4Hjg6Pjg6bjg4vjg4Pjg4jjgpLmjIflrppcclxuICAgIGdsLmFjdGl2ZVRleHR1cmUoZ2wuVEVYVFVSRTApO1xyXG4gICAgXHJcbiAgICAvLyDjg4bjgq/jgrnjg4Hjg6PnlKjlpInmlbDjga7lrqPoqIBcclxuICAgIHZhciB0ZXh0dXJlPW5ldyBBcnJheSgpO1xyXG4gICAgLy90ZXh0dXJlWzBdID0gbnVsbDtcclxuXHJcbiAgICB2YXIgcG9zWj1uZXcgQXJyYXkoKTtcclxuICAgIC8v44OG44Kv44K544OB44Oj5ZG844Gw44KM44Gf44KJXHJcbiAgICB2YXIgc29ja2V0ID1pbygpO1xyXG5cclxuICAgIC8vc29ja2V044Gu44Kk44OZ44Oz44OI44GM5L2V5Zue44GN44Gf44GL44GX44KJ44G544KLXHJcbiAgICB2YXIgZ2V0bnVtYmVyPTA7XHJcbiAgICAvL+OCteODvOODkOODvOOBi+OCieODh+ODvOOCv+OCkuWPl+OBkeWPluOCi1xyXG5cclxuICAgIHNvY2tldC5vbihcInB1c2hJbWFnZUZyb21TZXJ2ZXJcIixmdW5jdGlvbihkYXRhKXtcclxuICAgIC8vICAgIHZhciBpbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW1hZ2VcIik7XHJcbiAgICAgICAgY3JlYXRlX3RleHR1cmUoZ2wsZGF0YSxnZXRudW1iZXIpO1xyXG4gICAgICAgIHBvc1pbZ2V0bnVtYmVyXT0tMTA1O1xyXG4gICAgICAgIGdldG51bWJlcisrO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGdldG51bWJlcik7XHJcbiAgICAgICAgY29uc29sZS5sb2codGV4dHVyZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyDjg4bjgq/jgrnjg4Hjg6PjgpLnlJ/miJBcclxuICAgIC8vY3JlYXRlX3RleHR1cmUoZ2wsXCIuLi9pbWcvdGVzdC5qcGdcIiwwKTtcclxuICAgIC8vY3JlYXRlX3RleHR1cmUoZ2wsaW1nX2RhdGEpO1xyXG4gICAgLy8g44Kr44Km44Oz44K/44Gu5a6j6KiAXHJcbiAgICB2YXIgY291bnQgPSAwO1xyXG4gICAgdmFyIGNvdW50Mj0wO1xyXG4gICAgLy8g5oGS5bi444Or44O844OXXHJcbiAgICAoZnVuY3Rpb24gbG9vcCgpe1xyXG4gICAgICAgIC8vIGNhbnZhc+OCkuWIneacn+WMllxyXG4vLyAgICAgICAgZ2wuY2xlYXJDb2xvcigwLjAsIDAuMCwgMC4wLCAxLjApO1xyXG4gICAgICAgIHZhciBoc3YgPSBoc3ZhKGNvdW50MiAlIDM2MCwgMSwgMSwgMSk7XHJcbiAgICAgICAgZ2wuY2xlYXJDb2xvcihoc3ZbMF0sIGhzdlsxXSwgaHN2WzJdLCBoc3ZbM10pO1xyXG4gICAgICAgIGdsLmNsZWFyRGVwdGgoMS4wKTtcclxuICAgICAgICBnbC5jbGVhcihnbC5DT0xPUl9CVUZGRVJfQklUIHwgZ2wuREVQVEhfQlVGRkVSX0JJVCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g44Kr44Km44Oz44K/44KS5YWD44Gr44Op44K444Ki44Oz44KS566X5Ye6XHJcbiAgICAgICAgY291bnQrKztcclxuICAgICAgICBpZiAoY291bnQgJSAxMCA9PSAwKSB7XHJcbiAgICAgICAgICAgIGNvdW50MisrO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcmFkID0gKGNvdW50ICUgMzYwKSAqIE1hdGguUEkgLyAxODA7XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgLy8gIC8vIOODouODh+ODq+W6p+aomeWkieaPm+ihjOWIl+OBrueUn+aIkFxyXG4gICAgICAgLy8gIG0uaWRlbnRpdHkobU1hdHJpeCk7XHJcbiAgICAgICAvLyAgbS5yb3RhdGUobU1hdHJpeCwgcmFkLCBbMCwgMSwgMF0sIG1NYXRyaXgpO1xyXG4gICAgICAgLy8gIG0ubXVsdGlwbHkodG1wTWF0cml4LCBtTWF0cml4LCBtdnBNYXRyaXgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgLy8gIC8vIOODhuOCr+OCueODgeODo+OCkuODkOOCpOODs+ODieOBmeOCi1xyXG4gICAgICAgLy8gIGdsLmJpbmRUZXh0dXJlKGdsLlRFWFRVUkVfMkQsIHRleHR1cmVbMF0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgLy8gIC8vIHVuaWZvcm3lpInmlbDjgavjg4bjgq/jgrnjg4Hjg6PjgpLnmbvpjLJcclxuICAgICAgIC8vIGdsLnVuaWZvcm0xaSh1bmlMb2NhdGlvblsxXSwgMCk7XHJcblxyXG4gICAgICAgLy8gIC8vIHVuaWZvcm3lpInmlbDjga7nmbvpjLLjgajmj4/nlLtcclxuICAgICAgIC8vICBnbC51bmlmb3JtTWF0cml4NGZ2KHVuaUxvY2F0aW9uWzBdLCBmYWxzZSwgbXZwTWF0cml4KTtcclxuICAgICAgIC8vICBnbC5kcmF3RWxlbWVudHMoZ2wuVFJJQU5HTEVTLCBpbmRleC5sZW5ndGgsIGdsLlVOU0lHTkVEX1NIT1JULCAwKTtcclxuICAgICAgIGlmKHRleHR1cmUpe1xyXG4gICAgICAgICAgICBmb3IodmFyIGk9MDtpPHRleHR1cmUubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgICAgICBpZihwb3NaW2ldPT03KXtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0dXJlLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zWi5zaGlmdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgZm9yKHZhciBpPTA7aTx0ZXh0dXJlLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICBwb3NaW2ldKz0wLjU7XHJcbiAgICAgICAgICAgIGJpbmRQbGF0ZVBvbHkoZ2wsbSxtTWF0cml4LHJhZCx0bXBNYXRyaXgsbXZwTWF0cml4LHVuaUxvY2F0aW9uLGluZGV4LGkscG9zWltpXSk7XHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgfVxyXG4gICAgICAgIC8vIOOCs+ODs+ODhuOCreOCueODiOOBruWGjeaPj+eUu1xyXG4gICAgICAgIGdsLmZsdXNoKCk7XHJcblxyXG4gICAgICAgIC8vIOODq+ODvOODl+OBruOBn+OCgeOBq+WGjeW4sOWRvOOBs+WHuuOBl1xyXG4gICAgICAgIC8vc2V0VGltZW91dChsb29wLCAxMDAwIC8gMzApO1xyXG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcclxuICAgIH0pKCk7XHJcblxyXG4gICAgZnVuY3Rpb24gYmluZFBsYXRlUG9seShfZ2wsX20sX21NYXRyaXgsX3JhZCxfdG1wTWF0cml4LF9tdnBNYXRyaXgsX3VuaUxvY2F0aW9uLF9pbmRleCxfbnVtYmVyLF9wb3NaKXtcclxuICAgICAgICAvLyDjg6Ljg4fjg6vluqfmqJnlpInmj5vooYzliJfjga7nlJ/miJBcclxuICAgICAgICBfbS5pZGVudGl0eShfbU1hdHJpeCk7XHJcbiAgICAgICAgX20udHJhbnNsYXRlKF9tTWF0cml4LFswLDAsX3Bvc1pdLF9tTWF0cml4KTtcclxuICAgICAgICBfbS5yb3RhdGUoX21NYXRyaXgsIF9yYWQsIFswLCAxLCAwXSwgX21NYXRyaXgpO1xyXG4gICAgICAgIF9tLm11bHRpcGx5KF90bXBNYXRyaXgsIF9tTWF0cml4LCBfbXZwTWF0cml4KTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDjg4bjgq/jgrnjg4Hjg6PjgpLjg5DjgqTjg7Pjg4njgZnjgotcclxuICAgICAgICBfZ2wuYmluZFRleHR1cmUoX2dsLlRFWFRVUkVfMkQsIHRleHR1cmVbX251bWJlcl0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHVuaWZvcm3lpInmlbDjgavjg4bjgq/jgrnjg4Hjg6PjgpLnmbvpjLJcclxuICAgICAgIF9nbC51bmlmb3JtMWkoX3VuaUxvY2F0aW9uWzFdLCAwKTtcclxuXHJcbiAgICAgICAgLy8gdW5pZm9ybeWkieaVsOOBrueZu+mMsuOBqOaPj+eUu1xyXG4gICAgICAgIF9nbC51bmlmb3JtTWF0cml4NGZ2KF91bmlMb2NhdGlvblswXSwgZmFsc2UsIF9tdnBNYXRyaXgpO1xyXG4gICAgICAgIF9nbC5kcmF3RWxlbWVudHMoX2dsLlRSSUFOR0xFUywgX2luZGV4Lmxlbmd0aCwgX2dsLlVOU0lHTkVEX1NIT1JULCAwKTtcclxuICAgICAgICBcclxuICAgIH1cclxuICAgIC8vIOODhuOCr+OCueODgeODo+OCkueUn+aIkOOBmeOCi+mWouaVsFxyXG4gICAgZnVuY3Rpb24gY3JlYXRlX3RleHR1cmUoX2dsLF9zb3VyY2UsX24pe1xyXG4gICAgICAgIC8vIOOCpOODoeODvOOCuOOCquODluOCuOOCp+OCr+ODiOOBrueUn+aIkFxyXG4gICAgICAgIHZhciBpbWcgPSBuZXcgSW1hZ2UoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDjg4fjg7zjgr/jga7jgqrjg7Pjg63jg7zjg4njgpLjg4jjg6rjgqzjg7zjgavjgZnjgotcclxuICAgICAgICBpbWcub25sb2FkID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgLy8g44OG44Kv44K544OB44Oj44Kq44OW44K444Kn44Kv44OI44Gu55Sf5oiQXHJcbiAgICAgICAgICAgIHZhciB0ZXggPSBfZ2wuY3JlYXRlVGV4dHVyZSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8g44OG44Kv44K544OB44Oj44KS44OQ44Kk44Oz44OJ44GZ44KLXHJcbiAgICAgICAgICAgIF9nbC5iaW5kVGV4dHVyZShfZ2wuVEVYVFVSRV8yRCwgdGV4KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOODhuOCr+OCueODgeODo+OBuOOCpOODoeODvOOCuOOCkumBqeeUqFxyXG4gICAgICAgICAgICBfZ2wudGV4SW1hZ2UyRChfZ2wuVEVYVFVSRV8yRCwgMCwgX2dsLlJHQkEsIF9nbC5SR0JBLCBfZ2wuVU5TSUdORURfQllURSwgaW1nKTtcclxuICAgICAgICAgICAgX2dsLnRleFBhcmFtZXRlcmkoX2dsLlRFWFRVUkVfMkQsX2dsLlRFWFRVUkVfTUFHX0ZJTFRFUixfZ2wuTElORUFSKTtcclxuICAgICAgICAgICAgX2dsLnRleFBhcmFtZXRlcmkoX2dsLlRFWFRVUkVfMkQsX2dsLlRFWFRVUkVfTUlOX0ZJTFRFUixfZ2wuTElORUFSKTtcclxuICAgICAgICAgICAgX2dsLnRleFBhcmFtZXRlcmkoX2dsLlRFWFRVUkVfMkQsX2dsLlRFWFRVUkVfV1JBUF9TLF9nbC5DTEFNUF9UT19FREdFKTtcclxuICAgICAgICAgICAgX2dsLnRleFBhcmFtZXRlcmkoX2dsLlRFWFRVUkVfMkQsX2dsLlRFWFRVUkVfV1JBUF9ULF9nbC5DTEFNUF9UT19FREdFKTtcclxuXHJcbiAgICAgICAgICAgIC8vIOODn+ODg+ODl+ODnuODg+ODl+OCkueUn+aIkFxyXG4gICAgICAgICAgICBfZ2wuZ2VuZXJhdGVNaXBtYXAoX2dsLlRFWFRVUkVfMkQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8g44OG44Kv44K544OB44Oj44Gu44OQ44Kk44Oz44OJ44KS54Sh5Yq55YyWXHJcbiAgICAgICAgICAgIF9nbC5iaW5kVGV4dHVyZShfZ2wuVEVYVFVSRV8yRCwgbnVsbCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDnlJ/miJDjgZfjgZ/jg4bjgq/jgrnjg4Hjg6PjgpLjgrDjg63jg7zjg5Djg6vlpInmlbDjgavku6PlhaVcclxuICAgICAgICAgICAgdGV4dHVyZVtfbl0gPSB0ZXg7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDjgqTjg6Hjg7zjgrjjgqrjg5bjgrjjgqfjgq/jg4jjga7jgr3jg7zjgrnjgpLmjIflrppcclxuICAgICAgICBpbWcuc3JjID0gX3NvdXJjZTtcclxuICAgIH1cclxuICAgIFxyXG59O1xyXG5cclxuLy8g44K344Kn44O844OA44KS55Sf5oiQ44GZ44KL6Zai5pWwXHJcbmZ1bmN0aW9uIGNyZWF0ZV9zaGFkZXIoX2dsLF9pZCl7XHJcbiAgICAvLyDjgrfjgqfjg7zjg4DjgpLmoLzntI3jgZnjgovlpInmlbBcclxuICAgIHZhciBzaGFkZXI7XHJcbiAgICBcclxuICAgIC8vIEhUTUzjgYvjgolzY3JpcHTjgr/jgrDjgbjjga7lj4LnhafjgpLlj5blvpdcclxuICAgIHZhciBzY3JpcHRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoX2lkKTtcclxuICAgIFxyXG4gICAgLy8gc2NyaXB044K/44Kw44GM5a2Y5Zyo44GX44Gq44GE5aC05ZCI44Gv5oqc44GR44KLXHJcbiAgICBpZighc2NyaXB0RWxlbWVudCl7cmV0dXJuO31cclxuICAgIFxyXG4gICAgLy8gc2NyaXB044K/44Kw44GudHlwZeWxnuaAp+OCkuODgeOCp+ODg+OCr1xyXG4gICAgc3dpdGNoKHNjcmlwdEVsZW1lbnQudHlwZSl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g6aCC54K544K344Kn44O844OA44Gu5aC05ZCIXHJcbiAgICAgICAgY2FzZSAneC1zaGFkZXIveC12ZXJ0ZXgnOlxyXG4gICAgICAgICAgICBzaGFkZXIgPSBfZ2wuY3JlYXRlU2hhZGVyKF9nbC5WRVJURVhfU0hBREVSKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIC8vIOODleODqeOCsOODoeODs+ODiOOCt+OCp+ODvOODgOOBruWgtOWQiFxyXG4gICAgICAgIGNhc2UgJ3gtc2hhZGVyL3gtZnJhZ21lbnQnOlxyXG4gICAgICAgICAgICBzaGFkZXIgPSBfZ2wuY3JlYXRlU2hhZGVyKF9nbC5GUkFHTUVOVF9TSEFERVIpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0IDpcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDnlJ/miJDjgZXjgozjgZ/jgrfjgqfjg7zjg4Djgavjgr3jg7zjgrnjgpLlibLjgorlvZPjgabjgotcclxuICAgIF9nbC5zaGFkZXJTb3VyY2Uoc2hhZGVyLCBzY3JpcHRFbGVtZW50LnRleHQpO1xyXG4gICAgXHJcbiAgICAvLyDjgrfjgqfjg7zjg4DjgpLjgrPjg7Pjg5HjgqTjg6vjgZnjgotcclxuICAgIF9nbC5jb21waWxlU2hhZGVyKHNoYWRlcik7XHJcbiAgICBcclxuICAgIC8vIOOCt+OCp+ODvOODgOOBjOato+OBl+OBj+OCs+ODs+ODkeOCpOODq+OBleOCjOOBn+OBi+ODgeOCp+ODg+OCr1xyXG4gICAgaWYoX2dsLmdldFNoYWRlclBhcmFtZXRlcihzaGFkZXIsIF9nbC5DT01QSUxFX1NUQVRVUykpe1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOaIkOWKn+OBl+OBpuOBhOOBn+OCieOCt+OCp+ODvOODgOOCkui/lOOBl+OBpue1guS6hlxyXG4gICAgICAgIHJldHVybiBzaGFkZXI7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgICBcclxuICAgICAgICAvLyDlpLHmlZfjgZfjgabjgYTjgZ/jgonjgqjjg6njg7zjg63jgrDjgpLjgqLjg6njg7zjg4jjgZnjgotcclxuICAgICAgICBhbGVydChfZ2wuZ2V0U2hhZGVySW5mb0xvZyhzaGFkZXIpKTtcclxuICAgIH1cclxufVxyXG4vLyDjg5fjg63jgrDjg6njg6Djgqrjg5bjgrjjgqfjgq/jg4jjgpLnlJ/miJDjgZfjgrfjgqfjg7zjg4DjgpLjg6rjg7Pjgq/jgZnjgovplqLmlbBcclxuZnVuY3Rpb24gY3JlYXRlX3Byb2dyYW0oX2dsLF92cywgX2ZzKXtcclxuICAgIC8vIOODl+ODreOCsOODqeODoOOCquODluOCuOOCp+OCr+ODiOOBrueUn+aIkFxyXG4gICAgdmFyIHByb2dyYW0gPSBfZ2wuY3JlYXRlUHJvZ3JhbSgpO1xyXG4gICAgXHJcbiAgICAvLyDjg5fjg63jgrDjg6njg6Djgqrjg5bjgrjjgqfjgq/jg4jjgavjgrfjgqfjg7zjg4DjgpLlibLjgorlvZPjgabjgotcclxuICAgIF9nbC5hdHRhY2hTaGFkZXIocHJvZ3JhbSwgX3ZzKTtcclxuICAgIF9nbC5hdHRhY2hTaGFkZXIocHJvZ3JhbSwgX2ZzKTtcclxuICAgIFxyXG4gICAgLy8g44K344Kn44O844OA44KS44Oq44Oz44KvXHJcbiAgICBfZ2wubGlua1Byb2dyYW0ocHJvZ3JhbSk7XHJcbiAgICBcclxuICAgIC8vIOOCt+OCp+ODvOODgOOBruODquODs+OCr+OBjOato+OBl+OBj+ihjOOBquOCj+OCjOOBn+OBi+ODgeOCp+ODg+OCr1xyXG4gICAgaWYoX2dsLmdldFByb2dyYW1QYXJhbWV0ZXIocHJvZ3JhbSwgX2dsLkxJTktfU1RBVFVTKSl7XHJcbiAgICBcclxuICAgICAgICAvLyDmiJDlip/jgZfjgabjgYTjgZ/jgonjg5fjg63jgrDjg6njg6Djgqrjg5bjgrjjgqfjgq/jg4jjgpLmnInlirnjgavjgZnjgotcclxuICAgICAgICBfZ2wudXNlUHJvZ3JhbShwcm9ncmFtKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDjg5fjg63jgrDjg6njg6Djgqrjg5bjgrjjgqfjgq/jg4jjgpLov5TjgZfjgabntYLkuoZcclxuICAgICAgICByZXR1cm4gcHJvZ3JhbTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOWkseaVl+OBl+OBpuOBhOOBn+OCieOCqOODqeODvOODreOCsOOCkuOCouODqeODvOODiOOBmeOCi1xyXG4gICAgICAgIGFsZXJ0KF9nbC5nZXRQcm9ncmFtSW5mb0xvZyhwcm9ncmFtKSk7XHJcbiAgICB9XHJcbn1cclxuLy8gVkJP44KS55Sf5oiQ44GZ44KL6Zai5pWwXHJcbmZ1bmN0aW9uIGNyZWF0ZV92Ym8oX2dsLF9kYXRhKXtcclxuICAgIC8vIOODkOODg+ODleOCoeOCquODluOCuOOCp+OCr+ODiOOBrueUn+aIkFxyXG4gICAgdmFyIHZibyA9IF9nbC5jcmVhdGVCdWZmZXIoKTtcclxuICAgIFxyXG4gICAgLy8g44OQ44OD44OV44Kh44KS44OQ44Kk44Oz44OJ44GZ44KLXHJcbiAgICBfZ2wuYmluZEJ1ZmZlcihfZ2wuQVJSQVlfQlVGRkVSLCB2Ym8pO1xyXG4gICAgXHJcbiAgICAvLyDjg5Djg4Pjg5XjgqHjgavjg4fjg7zjgr/jgpLjgrvjg4Pjg4hcclxuICAgIF9nbC5idWZmZXJEYXRhKF9nbC5BUlJBWV9CVUZGRVIsIG5ldyBGbG9hdDMyQXJyYXkoX2RhdGEpLCBfZ2wuU1RBVElDX0RSQVcpO1xyXG4gICAgXHJcbiAgICAvLyDjg5Djg4Pjg5XjgqHjga7jg5DjgqTjg7Pjg4njgpLnhKHlirnljJZcclxuICAgIF9nbC5iaW5kQnVmZmVyKF9nbC5BUlJBWV9CVUZGRVIsIG51bGwpO1xyXG4gICAgXHJcbiAgICAvLyDnlJ/miJDjgZfjgZ8gVkJPIOOCkui/lOOBl+OBpue1guS6hlxyXG4gICAgcmV0dXJuIHZibztcclxufVxyXG4vLyBWQk/jgpLjg5DjgqTjg7Pjg4njgZfnmbvpjLLjgZnjgovplqLmlbBcclxuZnVuY3Rpb24gc2V0X2F0dHJpYnV0ZShfZ2wsX3ZibywgX2F0dEwsIF9hdHRTKXtcclxuICAgIC8vIOW8leaVsOOBqOOBl+OBpuWPl+OBkeWPluOBo+OBn+mFjeWIl+OCkuWHpueQhuOBmeOCi1xyXG4gICAgZm9yKHZhciBpIGluIF92Ym8pe1xyXG4gICAgICAgIC8vIOODkOODg+ODleOCoeOCkuODkOOCpOODs+ODieOBmeOCi1xyXG4gICAgICAgIF9nbC5iaW5kQnVmZmVyKF9nbC5BUlJBWV9CVUZGRVIsIF92Ym9baV0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIGF0dHJpYnV0ZUxvY2F0aW9u44KS5pyJ5Yq544Gr44GZ44KLXHJcbiAgICAgICAgX2dsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KF9hdHRMW2ldKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBhdHRyaWJ1dGVMb2NhdGlvbuOCkumAmuefpeOBl+eZu+mMsuOBmeOCi1xyXG4gICAgICAgIF9nbC52ZXJ0ZXhBdHRyaWJQb2ludGVyKF9hdHRMW2ldLCBfYXR0U1tpXSwgX2dsLkZMT0FULCBmYWxzZSwgMCwgMCk7XHJcbiAgICB9XHJcbn1cclxuLy8gSUJP44KS55Sf5oiQ44GZ44KL6Zai5pWwXHJcbmZ1bmN0aW9uIGNyZWF0ZV9pYm8oX2dsLF9kYXRhKXtcclxuICAgIC8vIOODkOODg+ODleOCoeOCquODluOCuOOCp+OCr+ODiOOBrueUn+aIkFxyXG4gICAgdmFyIGlibyA9IF9nbC5jcmVhdGVCdWZmZXIoKTtcclxuICAgIFxyXG4gICAgLy8g44OQ44OD44OV44Kh44KS44OQ44Kk44Oz44OJ44GZ44KLXHJcbiAgICBfZ2wuYmluZEJ1ZmZlcihfZ2wuRUxFTUVOVF9BUlJBWV9CVUZGRVIsIGlibyk7XHJcbiAgICBcclxuICAgIC8vIOODkOODg+ODleOCoeOBq+ODh+ODvOOCv+OCkuOCu+ODg+ODiFxyXG4gICAgX2dsLmJ1ZmZlckRhdGEoX2dsLkVMRU1FTlRfQVJSQVlfQlVGRkVSLCBuZXcgSW50MTZBcnJheShfZGF0YSksIF9nbC5TVEFUSUNfRFJBVyk7XHJcbiAgICBcclxuICAgIC8vIOODkOODg+ODleOCoeOBruODkOOCpOODs+ODieOCkueEoeWKueWMllxyXG4gICAgX2dsLmJpbmRCdWZmZXIoX2dsLkVMRU1FTlRfQVJSQVlfQlVGRkVSLCBudWxsKTtcclxuICAgIFxyXG4gICAgLy8g55Sf5oiQ44GX44GfSUJP44KS6L+U44GX44Gm57WC5LqGXHJcbiAgICByZXR1cm4gaWJvO1xyXG59Il19
