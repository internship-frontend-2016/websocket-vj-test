(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

onload = function onload() {
    var socket = io();
    //サーバーからデータを受け取る
    socket.on("pushImageFromServer", function (data) {
        //    var image = document.getElementById("image");
        console.log(data);
        init(data);
        //    image.src=data;
    });
};

function init(img_data) {
    // canvasエレメントを取得
    var c = document.getElementById('canvas');
    c.width = 500;
    c.height = 300;

    console.log("hi");
    // webglコンテキストを取得
    var gl = c.getContext('webgl') || c.getContext('experimental-webgl');
    console.log(gl);
    // 頂点シェーダとフラグメントシェーダの生成
    var v_shader = create_shader('vs');
    var f_shader = create_shader('fs');

    // プログラムオブジェクトの生成とリンク
    var prg = create_program(v_shader, f_shader);

    // attributeLocationを配列に取得
    var attLocation = new Array();
    attLocation[0] = gl.getAttribLocation(prg, 'position');
    attLocation[1] = gl.getAttribLocation(prg, 'color');
    attLocation[2] = gl.getAttribLocation(prg, 'textureCoord');

    // attributeの要素数を配列に格納
    var attStride = new Array();
    attStride[0] = 3;
    attStride[1] = 4;
    attStride[2] = 2;

    // 頂点の位置
    var position = [-1.0, 1.0, 0.0, 1.0, 1.0, 0.0, -1.0, -1.0, 0.0, 1.0, -1.0, 0.0];

    // 頂点色
    var color = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0];

    // テクスチャ座標
    var textureCoord = [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0];

    // 頂点インデックス
    var index = [0, 1, 2, 3, 2, 1];

    // VBOとIBOの生成
    var vPosition = create_vbo(position);
    var vColor = create_vbo(color);
    var vTextureCoord = create_vbo(textureCoord);
    var VBOList = [vPosition, vColor, vTextureCoord];
    var iIndex = create_ibo(index);

    // VBOとIBOの登録
    set_attribute(VBOList, attLocation, attStride);
    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, iIndex);

    // uniformLocationを配列に取得
    var uniLocation = new Array();
    uniLocation[0] = gl.getUniformLocation(prg, 'mvpMatrix');
    uniLocation[1] = gl.getUniformLocation(prg, 'texture');

    // 各種行列の生成と初期化
    var m = new matIV();
    var mMatrix = m.identity(m.create());
    var vMatrix = m.identity(m.create());
    var pMatrix = m.identity(m.create());
    var tmpMatrix = m.identity(m.create());
    var mvpMatrix = m.identity(m.create());

    // ビュー×プロジェクション座標変換行列
    m.lookAt([0.0, 2.0, 5.0], [0, 0, 0], [0, 1, 0], vMatrix);
    m.perspective(45, c.width / c.height, 0.1, 100, pMatrix);
    m.multiply(pMatrix, vMatrix, tmpMatrix);

    // 深度テストを有効にする
    gl.enable(gl.DEPTH_TEST);
    gl.depthFunc(gl.LEQUAL);

    // 有効にするテクスチャユニットを指定
    gl.activeTexture(gl.TEXTURE0);

    // テクスチャ用変数の宣言
    var texture = null;

    // テクスチャを生成
    //    create_texture("../img/test.jpg");
    create_texture(img_data);
    // カウンタの宣言
    var count = 0;

    // 恒常ループ
    (function loop() {
        // canvasを初期化
        gl.clearColor(0.0, 0.0, 0.0, 1.0);
        gl.clearDepth(1.0);
        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);

        // カウンタを元にラジアンを算出
        count++;
        var rad = count % 360 * Math.PI / 180;

        // テクスチャをバインドする
        gl.bindTexture(gl.TEXTURE_2D, texture);

        // uniform変数にテクスチャを登録
        gl.uniform1i(uniLocation[1], 0);

        // モデル座標変換行列の生成
        m.identity(mMatrix);
        m.rotate(mMatrix, rad, [0, 1, 0], mMatrix);
        m.multiply(tmpMatrix, mMatrix, mvpMatrix);

        // uniform変数の登録と描画
        gl.uniformMatrix4fv(uniLocation[0], false, mvpMatrix);
        gl.drawElements(gl.TRIANGLES, index.length, gl.UNSIGNED_SHORT, 0);

        // コンテキストの再描画
        gl.flush();

        // ループのために再帰呼び出し
        //setTimeout(loop, 1000 / 30);
        requestAnimationFrame(loop);
    })();

    // シェーダを生成する関数
    function create_shader(id) {
        // シェーダを格納する変数
        var shader;

        // HTMLからscriptタグへの参照を取得
        var scriptElement = document.getElementById(id);

        // scriptタグが存在しない場合は抜ける
        if (!scriptElement) {
            return;
        }

        // scriptタグのtype属性をチェック
        switch (scriptElement.type) {

            // 頂点シェーダの場合
            case 'x-shader/x-vertex':
                shader = gl.createShader(gl.VERTEX_SHADER);
                break;

            // フラグメントシェーダの場合
            case 'x-shader/x-fragment':
                shader = gl.createShader(gl.FRAGMENT_SHADER);
                break;
            default:
                return;
        }

        // 生成されたシェーダにソースを割り当てる
        gl.shaderSource(shader, scriptElement.text);

        // シェーダをコンパイルする
        gl.compileShader(shader);

        // シェーダが正しくコンパイルされたかチェック
        if (gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {

            // 成功していたらシェーダを返して終了
            return shader;
        } else {

            // 失敗していたらエラーログをアラートする
            alert(gl.getShaderInfoLog(shader));
        }
    }

    // プログラムオブジェクトを生成しシェーダをリンクする関数
    function create_program(vs, fs) {
        // プログラムオブジェクトの生成
        var program = gl.createProgram();

        // プログラムオブジェクトにシェーダを割り当てる
        gl.attachShader(program, vs);
        gl.attachShader(program, fs);

        // シェーダをリンク
        gl.linkProgram(program);

        // シェーダのリンクが正しく行なわれたかチェック
        if (gl.getProgramParameter(program, gl.LINK_STATUS)) {

            // 成功していたらプログラムオブジェクトを有効にする
            gl.useProgram(program);

            // プログラムオブジェクトを返して終了
            return program;
        } else {

            // 失敗していたらエラーログをアラートする
            alert(gl.getProgramInfoLog(program));
        }
    }

    // VBOを生成する関数
    function create_vbo(data) {
        // バッファオブジェクトの生成
        var vbo = gl.createBuffer();

        // バッファをバインドする
        gl.bindBuffer(gl.ARRAY_BUFFER, vbo);

        // バッファにデータをセット
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(data), gl.STATIC_DRAW);

        // バッファのバインドを無効化
        gl.bindBuffer(gl.ARRAY_BUFFER, null);

        // 生成した VBO を返して終了
        return vbo;
    }

    // VBOをバインドし登録する関数
    function set_attribute(vbo, attL, attS) {
        // 引数として受け取った配列を処理する
        for (var i in vbo) {
            // バッファをバインドする
            gl.bindBuffer(gl.ARRAY_BUFFER, vbo[i]);

            // attributeLocationを有効にする
            gl.enableVertexAttribArray(attL[i]);

            // attributeLocationを通知し登録する
            gl.vertexAttribPointer(attL[i], attS[i], gl.FLOAT, false, 0, 0);
        }
    }

    // IBOを生成する関数
    function create_ibo(data) {
        // バッファオブジェクトの生成
        var ibo = gl.createBuffer();

        // バッファをバインドする
        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);

        // バッファにデータをセット
        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Int16Array(data), gl.STATIC_DRAW);

        // バッファのバインドを無効化
        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);

        // 生成したIBOを返して終了
        return ibo;
    }

    // テクスチャを生成する関数
    function create_texture(source) {
        // イメージオブジェクトの生成
        var img = new Image();

        // データのオンロードをトリガーにする
        img.onload = function () {
            // テクスチャオブジェクトの生成
            var tex = gl.createTexture();

            // テクスチャをバインドする
            gl.bindTexture(gl.TEXTURE_2D, tex);

            // テクスチャへイメージを適用
            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, img);
            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);

            // ミップマップを生成
            gl.generateMipmap(gl.TEXTURE_2D);

            // テクスチャのバインドを無効化
            gl.bindTexture(gl.TEXTURE_2D, null);

            // 生成したテクスチャをグローバル変数に代入
            texture = tex;
        };

        // イメージオブジェクトのソースを指定
        img.src = source;
    }
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmNcXGpzXFx3ZWJJbWFnZVB1c2guanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0NBLFNBQU8sa0JBQVU7QUFDYixRQUFJLFNBQVEsSUFBWjtBQUNBO0FBQ0EsV0FBTyxFQUFQLENBQVUscUJBQVYsRUFBZ0MsVUFBUyxJQUFULEVBQWM7QUFDOUM7QUFDSSxnQkFBUSxHQUFSLENBQVksSUFBWjtBQUNBLGFBQUssSUFBTDtBQUNKO0FBQ0MsS0FMRDtBQU1ILENBVEQ7O0FBV0EsU0FBUyxJQUFULENBQWMsUUFBZCxFQUF1QjtBQUNuQjtBQUNBLFFBQUksSUFBSSxTQUFTLGNBQVQsQ0FBd0IsUUFBeEIsQ0FBUjtBQUNBLE1BQUUsS0FBRixHQUFVLEdBQVY7QUFDQSxNQUFFLE1BQUYsR0FBVyxHQUFYOztBQUVBLFlBQVEsR0FBUixDQUFZLElBQVo7QUFDQTtBQUNBLFFBQUksS0FBSyxFQUFFLFVBQUYsQ0FBYSxPQUFiLEtBQXlCLEVBQUUsVUFBRixDQUFhLG9CQUFiLENBQWxDO0FBQ0EsWUFBUSxHQUFSLENBQVksRUFBWjtBQUNBO0FBQ0EsUUFBSSxXQUFXLGNBQWMsSUFBZCxDQUFmO0FBQ0EsUUFBSSxXQUFXLGNBQWMsSUFBZCxDQUFmOztBQUVBO0FBQ0EsUUFBSSxNQUFNLGVBQWUsUUFBZixFQUF5QixRQUF6QixDQUFWOztBQUVBO0FBQ0EsUUFBSSxjQUFjLElBQUksS0FBSixFQUFsQjtBQUNBLGdCQUFZLENBQVosSUFBaUIsR0FBRyxpQkFBSCxDQUFxQixHQUFyQixFQUEwQixVQUExQixDQUFqQjtBQUNBLGdCQUFZLENBQVosSUFBaUIsR0FBRyxpQkFBSCxDQUFxQixHQUFyQixFQUEwQixPQUExQixDQUFqQjtBQUNBLGdCQUFZLENBQVosSUFBaUIsR0FBRyxpQkFBSCxDQUFxQixHQUFyQixFQUEwQixjQUExQixDQUFqQjs7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LE1BQXhCLEVBQStCO0FBQzNCO0FBQ0EsWUFBSSxNQUFNLElBQUksS0FBSixFQUFWOztBQUVBO0FBQ0EsWUFBSSxNQUFKLEdBQWEsWUFBVTtBQUNuQjtBQUNBLGdCQUFJLE1BQU0sR0FBRyxhQUFILEVBQVY7O0FBRUE7QUFDQSxlQUFHLFdBQUgsQ0FBZSxHQUFHLFVBQWxCLEVBQThCLEdBQTlCOztBQUVBO0FBQ0EsZUFBRyxVQUFILENBQWMsR0FBRyxVQUFqQixFQUE2QixDQUE3QixFQUFnQyxHQUFHLElBQW5DLEVBQXlDLEdBQUcsSUFBNUMsRUFBa0QsR0FBRyxhQUFyRCxFQUFvRSxHQUFwRTtBQUNKLGVBQUcsYUFBSCxDQUFpQixHQUFHLFVBQXBCLEVBQStCLEdBQUcsa0JBQWxDLEVBQXFELEdBQUcsTUFBeEQ7QUFDQSxlQUFHLGFBQUgsQ0FBaUIsR0FBRyxVQUFwQixFQUErQixHQUFHLGtCQUFsQyxFQUFxRCxHQUFHLE1BQXhEO0FBQ0EsZUFBRyxhQUFILENBQWlCLEdBQUcsVUFBcEIsRUFBK0IsR0FBRyxjQUFsQyxFQUFpRCxHQUFHLGFBQXBEO0FBQ0EsZUFBRyxhQUFILENBQWlCLEdBQUcsVUFBcEIsRUFBK0IsR0FBRyxjQUFsQyxFQUFpRCxHQUFHLGFBQXBEOztBQUdJO0FBQ0EsZUFBRyxjQUFILENBQWtCLEdBQUcsVUFBckI7O0FBRUE7QUFDQSxlQUFHLFdBQUgsQ0FBZSxHQUFHLFVBQWxCLEVBQThCLElBQTlCOztBQUVBO0FBQ0Esc0JBQVUsR0FBVjtBQUNILFNBdkJEOztBQXlCQTtBQUNBLFlBQUksR0FBSixHQUFVLE1BQVY7QUFDSDtBQUVKIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIlxyXG5vbmxvYWQ9ZnVuY3Rpb24oKXtcclxuICAgIHZhciBzb2NrZXQgPWlvKCk7XHJcbiAgICAvL+OCteODvOODkOODvOOBi+OCieODh+ODvOOCv+OCkuWPl+OBkeWPluOCi1xyXG4gICAgc29ja2V0Lm9uKFwicHVzaEltYWdlRnJvbVNlcnZlclwiLGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgLy8gICAgdmFyIGltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbWFnZVwiKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICBpbml0KGRhdGEpO1xyXG4gICAgLy8gICAgaW1hZ2Uuc3JjPWRhdGE7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdChpbWdfZGF0YSl7XHJcbiAgICAvLyBjYW52YXPjgqjjg6zjg6Hjg7Pjg4jjgpLlj5blvpdcclxuICAgIHZhciBjID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcycpO1xyXG4gICAgYy53aWR0aCA9IDUwMDtcclxuICAgIGMuaGVpZ2h0ID0gMzAwO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhcImhpXCIpO1xyXG4gICAgLy8gd2ViZ2zjgrPjg7Pjg4bjgq3jgrnjg4jjgpLlj5blvpdcclxuICAgIHZhciBnbCA9IGMuZ2V0Q29udGV4dCgnd2ViZ2wnKSB8fCBjLmdldENvbnRleHQoJ2V4cGVyaW1lbnRhbC13ZWJnbCcpO1xyXG4gICAgY29uc29sZS5sb2coZ2wpO1xyXG4gICAgLy8g6aCC54K544K344Kn44O844OA44Go44OV44Op44Kw44Oh44Oz44OI44K344Kn44O844OA44Gu55Sf5oiQXHJcbiAgICB2YXIgdl9zaGFkZXIgPSBjcmVhdGVfc2hhZGVyKCd2cycpO1xyXG4gICAgdmFyIGZfc2hhZGVyID0gY3JlYXRlX3NoYWRlcignZnMnKTtcclxuICAgIFxyXG4gICAgLy8g44OX44Ot44Kw44Op44Og44Kq44OW44K444Kn44Kv44OI44Gu55Sf5oiQ44Go44Oq44Oz44KvXHJcbiAgICB2YXIgcHJnID0gY3JlYXRlX3Byb2dyYW0odl9zaGFkZXIsIGZfc2hhZGVyKTtcclxuICAgIFxyXG4gICAgLy8gYXR0cmlidXRlTG9jYXRpb27jgpLphY3liJfjgavlj5blvpdcclxuICAgIHZhciBhdHRMb2NhdGlvbiA9IG5ldyBBcnJheSgpO1xyXG4gICAgYXR0TG9jYXRpb25bMF0gPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihwcmcsICdwb3NpdGlvbicpO1xyXG4gICAgYXR0TG9jYXRpb25bMV0gPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihwcmcsICdjb2xvcicpO1xyXG4gICAgYXR0TG9jYXRpb25bMl0gPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihwcmcsICd0ZXh0dXJlQ29vcmQnKTtcclxuICAgIFxyXG4gICAgLy8gYXR0cmlidXRl44Gu6KaB57Sg5pWw44KS6YWN5YiX44Gr5qC857SNXHJcbiAgICB2YXIgYXR0U3RyaWRlID0gbmV3IEFycmF5KCk7XHJcbiAgICBhdHRTdHJpZGVbMF0gPSAzO1xyXG4gICAgYXR0U3RyaWRlWzFdID0gNDtcclxuICAgIGF0dFN0cmlkZVsyXSA9IDI7XHJcbiAgICBcclxuICAgIC8vIOmggueCueOBruS9jee9rlxyXG4gICAgdmFyIHBvc2l0aW9uID0gW1xyXG4gICAgICAgIC0xLjAsICAxLjAsICAwLjAsXHJcbiAgICAgICAgIDEuMCwgIDEuMCwgIDAuMCxcclxuICAgICAgICAtMS4wLCAtMS4wLCAgMC4wLFxyXG4gICAgICAgICAxLjAsIC0xLjAsICAwLjBcclxuICAgIF07XHJcbiAgICBcclxuICAgIC8vIOmggueCueiJslxyXG4gICAgdmFyIGNvbG9yID0gW1xyXG4gICAgICAgIDEuMCwgMS4wLCAxLjAsIDEuMCxcclxuICAgICAgICAxLjAsIDEuMCwgMS4wLCAxLjAsXHJcbiAgICAgICAgMS4wLCAxLjAsIDEuMCwgMS4wLFxyXG4gICAgICAgIDEuMCwgMS4wLCAxLjAsIDEuMFxyXG4gICAgXTtcclxuICAgIFxyXG4gICAgLy8g44OG44Kv44K544OB44Oj5bqn5qiZXHJcbiAgICB2YXIgdGV4dHVyZUNvb3JkID0gW1xyXG4gICAgICAgIDAuMCwgMC4wLFxyXG4gICAgICAgIDEuMCwgMC4wLFxyXG4gICAgICAgIDAuMCwgMS4wLFxyXG4gICAgICAgIDEuMCwgMS4wXHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICAvLyDpoILngrnjgqTjg7Pjg4fjg4Pjgq/jgrlcclxuICAgIHZhciBpbmRleCA9IFtcclxuICAgICAgICAwLCAxLCAyLFxyXG4gICAgICAgIDMsIDIsIDFcclxuICAgIF07XHJcbiAgICBcclxuICAgIC8vIFZCT+OBqElCT+OBrueUn+aIkFxyXG4gICAgdmFyIHZQb3NpdGlvbiAgICAgPSBjcmVhdGVfdmJvKHBvc2l0aW9uKTtcclxuICAgIHZhciB2Q29sb3IgICAgICAgID0gY3JlYXRlX3Zibyhjb2xvcik7XHJcbiAgICB2YXIgdlRleHR1cmVDb29yZCA9IGNyZWF0ZV92Ym8odGV4dHVyZUNvb3JkKTtcclxuICAgIHZhciBWQk9MaXN0ICAgICAgID0gW3ZQb3NpdGlvbiwgdkNvbG9yLCB2VGV4dHVyZUNvb3JkXTtcclxuICAgIHZhciBpSW5kZXggICAgICAgID0gY3JlYXRlX2libyhpbmRleCk7XHJcbiAgICBcclxuICAgIC8vIFZCT+OBqElCT+OBrueZu+mMslxyXG4gICAgc2V0X2F0dHJpYnV0ZShWQk9MaXN0LCBhdHRMb2NhdGlvbiwgYXR0U3RyaWRlKTtcclxuICAgIGdsLmJpbmRCdWZmZXIoZ2wuRUxFTUVOVF9BUlJBWV9CVUZGRVIsIGlJbmRleCk7XHJcbiAgICBcclxuICAgIC8vIHVuaWZvcm1Mb2NhdGlvbuOCkumFjeWIl+OBq+WPluW+l1xyXG4gICAgdmFyIHVuaUxvY2F0aW9uID0gbmV3IEFycmF5KCk7XHJcbiAgICB1bmlMb2NhdGlvblswXSAgPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ocHJnLCAnbXZwTWF0cml4Jyk7XHJcbiAgICB1bmlMb2NhdGlvblsxXSAgPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ocHJnLCAndGV4dHVyZScpO1xyXG4gICAgXHJcbiAgICAvLyDlkITnqK7ooYzliJfjga7nlJ/miJDjgajliJ3mnJ/ljJZcclxuICAgIHZhciBtID0gbmV3IG1hdElWKCk7XHJcbiAgICB2YXIgbU1hdHJpeCAgID0gbS5pZGVudGl0eShtLmNyZWF0ZSgpKTtcclxuICAgIHZhciB2TWF0cml4ICAgPSBtLmlkZW50aXR5KG0uY3JlYXRlKCkpO1xyXG4gICAgdmFyIHBNYXRyaXggICA9IG0uaWRlbnRpdHkobS5jcmVhdGUoKSk7XHJcbiAgICB2YXIgdG1wTWF0cml4ID0gbS5pZGVudGl0eShtLmNyZWF0ZSgpKTtcclxuICAgIHZhciBtdnBNYXRyaXggPSBtLmlkZW50aXR5KG0uY3JlYXRlKCkpO1xyXG4gICAgXHJcbiAgICAvLyDjg5Pjg6Xjg7zDl+ODl+ODreOCuOOCp+OCr+OCt+ODp+ODs+W6p+aomeWkieaPm+ihjOWIl1xyXG4gICAgbS5sb29rQXQoWzAuMCwgMi4wLCA1LjBdLCBbMCwgMCwgMF0sIFswLCAxLCAwXSwgdk1hdHJpeCk7XHJcbiAgICBtLnBlcnNwZWN0aXZlKDQ1LCBjLndpZHRoIC8gYy5oZWlnaHQsIDAuMSwgMTAwLCBwTWF0cml4KTtcclxuICAgIG0ubXVsdGlwbHkocE1hdHJpeCwgdk1hdHJpeCwgdG1wTWF0cml4KTtcclxuICAgIFxyXG4gICAgLy8g5rex5bqm44OG44K544OI44KS5pyJ5Yq544Gr44GZ44KLXHJcbiAgICBnbC5lbmFibGUoZ2wuREVQVEhfVEVTVCk7XHJcbiAgICBnbC5kZXB0aEZ1bmMoZ2wuTEVRVUFMKTtcclxuICAgIFxyXG4gICAgLy8g5pyJ5Yq544Gr44GZ44KL44OG44Kv44K544OB44Oj44Om44OL44OD44OI44KS5oyH5a6aXHJcbiAgICBnbC5hY3RpdmVUZXh0dXJlKGdsLlRFWFRVUkUwKTtcclxuICAgIFxyXG4gICAgLy8g44OG44Kv44K544OB44Oj55So5aSJ5pWw44Gu5a6j6KiAXHJcbiAgICB2YXIgdGV4dHVyZSA9IG51bGw7XHJcbiAgICBcclxuICAgIC8vIOODhuOCr+OCueODgeODo+OCkueUn+aIkFxyXG4vLyAgICBjcmVhdGVfdGV4dHVyZShcIi4uL2ltZy90ZXN0LmpwZ1wiKTtcclxuICAgIGNyZWF0ZV90ZXh0dXJlKGltZ19kYXRhKTtcclxuICAgIC8vIOOCq+OCpuODs+OCv+OBruWuo+iogFxyXG4gICAgdmFyIGNvdW50ID0gMDtcclxuICAgIFxyXG4gICAgLy8g5oGS5bi444Or44O844OXXHJcbiAgICAoZnVuY3Rpb24gbG9vcCgpe1xyXG4gICAgICAgIC8vIGNhbnZhc+OCkuWIneacn+WMllxyXG4gICAgICAgIGdsLmNsZWFyQ29sb3IoMC4wLCAwLjAsIDAuMCwgMS4wKTtcclxuICAgICAgICBnbC5jbGVhckRlcHRoKDEuMCk7XHJcbiAgICAgICAgZ2wuY2xlYXIoZ2wuQ09MT1JfQlVGRkVSX0JJVCB8IGdsLkRFUFRIX0JVRkZFUl9CSVQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOOCq+OCpuODs+OCv+OCkuWFg+OBq+ODqeOCuOOCouODs+OCkueul+WHulxyXG4gICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgdmFyIHJhZCA9IChjb3VudCAlIDM2MCkgKiBNYXRoLlBJIC8gMTgwO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOODhuOCr+OCueODgeODo+OCkuODkOOCpOODs+ODieOBmeOCi1xyXG4gICAgICAgIGdsLmJpbmRUZXh0dXJlKGdsLlRFWFRVUkVfMkQsIHRleHR1cmUpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHVuaWZvcm3lpInmlbDjgavjg4bjgq/jgrnjg4Hjg6PjgpLnmbvpjLJcclxuICAgICAgICBnbC51bmlmb3JtMWkodW5pTG9jYXRpb25bMV0sIDApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOODouODh+ODq+W6p+aomeWkieaPm+ihjOWIl+OBrueUn+aIkFxyXG4gICAgICAgIG0uaWRlbnRpdHkobU1hdHJpeCk7XHJcbiAgICAgICAgbS5yb3RhdGUobU1hdHJpeCwgcmFkLCBbMCwgMSwgMF0sIG1NYXRyaXgpO1xyXG4gICAgICAgIG0ubXVsdGlwbHkodG1wTWF0cml4LCBtTWF0cml4LCBtdnBNYXRyaXgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHVuaWZvcm3lpInmlbDjga7nmbvpjLLjgajmj4/nlLtcclxuICAgICAgICBnbC51bmlmb3JtTWF0cml4NGZ2KHVuaUxvY2F0aW9uWzBdLCBmYWxzZSwgbXZwTWF0cml4KTtcclxuICAgICAgICBnbC5kcmF3RWxlbWVudHMoZ2wuVFJJQU5HTEVTLCBpbmRleC5sZW5ndGgsIGdsLlVOU0lHTkVEX1NIT1JULCAwKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDjgrPjg7Pjg4bjgq3jgrnjg4jjga7lho3mj4/nlLtcclxuICAgICAgICBnbC5mbHVzaCgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOODq+ODvOODl+OBruOBn+OCgeOBq+WGjeW4sOWRvOOBs+WHuuOBl1xyXG4gICAgICAgIC8vc2V0VGltZW91dChsb29wLCAxMDAwIC8gMzApO1xyXG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcclxuICAgIH0pKCk7XHJcbiAgICBcclxuICAgIC8vIOOCt+OCp+ODvOODgOOCkueUn+aIkOOBmeOCi+mWouaVsFxyXG4gICAgZnVuY3Rpb24gY3JlYXRlX3NoYWRlcihpZCl7XHJcbiAgICAgICAgLy8g44K344Kn44O844OA44KS5qC857SN44GZ44KL5aSJ5pWwXHJcbiAgICAgICAgdmFyIHNoYWRlcjtcclxuICAgICAgICBcclxuICAgICAgICAvLyBIVE1M44GL44KJc2NyaXB044K/44Kw44G444Gu5Y+C54Wn44KS5Y+W5b6XXHJcbiAgICAgICAgdmFyIHNjcmlwdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gc2NyaXB044K/44Kw44GM5a2Y5Zyo44GX44Gq44GE5aC05ZCI44Gv5oqc44GR44KLXHJcbiAgICAgICAgaWYoIXNjcmlwdEVsZW1lbnQpe3JldHVybjt9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gc2NyaXB044K/44Kw44GudHlwZeWxnuaAp+OCkuODgeOCp+ODg+OCr1xyXG4gICAgICAgIHN3aXRjaChzY3JpcHRFbGVtZW50LnR5cGUpe1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8g6aCC54K544K344Kn44O844OA44Gu5aC05ZCIXHJcbiAgICAgICAgICAgIGNhc2UgJ3gtc2hhZGVyL3gtdmVydGV4JzpcclxuICAgICAgICAgICAgICAgIHNoYWRlciA9IGdsLmNyZWF0ZVNoYWRlcihnbC5WRVJURVhfU0hBREVSKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOODleODqeOCsOODoeODs+ODiOOCt+OCp+ODvOODgOOBruWgtOWQiFxyXG4gICAgICAgICAgICBjYXNlICd4LXNoYWRlci94LWZyYWdtZW50JzpcclxuICAgICAgICAgICAgICAgIHNoYWRlciA9IGdsLmNyZWF0ZVNoYWRlcihnbC5GUkFHTUVOVF9TSEFERVIpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQgOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyDnlJ/miJDjgZXjgozjgZ/jgrfjgqfjg7zjg4Djgavjgr3jg7zjgrnjgpLlibLjgorlvZPjgabjgotcclxuICAgICAgICBnbC5zaGFkZXJTb3VyY2Uoc2hhZGVyLCBzY3JpcHRFbGVtZW50LnRleHQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOOCt+OCp+ODvOODgOOCkuOCs+ODs+ODkeOCpOODq+OBmeOCi1xyXG4gICAgICAgIGdsLmNvbXBpbGVTaGFkZXIoc2hhZGVyKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDjgrfjgqfjg7zjg4DjgYzmraPjgZfjgY/jgrPjg7Pjg5HjgqTjg6vjgZXjgozjgZ/jgYvjg4Hjgqfjg4Pjgq9cclxuICAgICAgICBpZihnbC5nZXRTaGFkZXJQYXJhbWV0ZXIoc2hhZGVyLCBnbC5DT01QSUxFX1NUQVRVUykpe1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8g5oiQ5Yqf44GX44Gm44GE44Gf44KJ44K344Kn44O844OA44KS6L+U44GX44Gm57WC5LqGXHJcbiAgICAgICAgICAgIHJldHVybiBzaGFkZXI7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDlpLHmlZfjgZfjgabjgYTjgZ/jgonjgqjjg6njg7zjg63jgrDjgpLjgqLjg6njg7zjg4jjgZnjgotcclxuICAgICAgICAgICAgYWxlcnQoZ2wuZ2V0U2hhZGVySW5mb0xvZyhzaGFkZXIpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIOODl+ODreOCsOODqeODoOOCquODluOCuOOCp+OCr+ODiOOCkueUn+aIkOOBl+OCt+OCp+ODvOODgOOCkuODquODs+OCr+OBmeOCi+mWouaVsFxyXG4gICAgZnVuY3Rpb24gY3JlYXRlX3Byb2dyYW0odnMsIGZzKXtcclxuICAgICAgICAvLyDjg5fjg63jgrDjg6njg6Djgqrjg5bjgrjjgqfjgq/jg4jjga7nlJ/miJBcclxuICAgICAgICB2YXIgcHJvZ3JhbSA9IGdsLmNyZWF0ZVByb2dyYW0oKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDjg5fjg63jgrDjg6njg6Djgqrjg5bjgrjjgqfjgq/jg4jjgavjgrfjgqfjg7zjg4DjgpLlibLjgorlvZPjgabjgotcclxuICAgICAgICBnbC5hdHRhY2hTaGFkZXIocHJvZ3JhbSwgdnMpO1xyXG4gICAgICAgIGdsLmF0dGFjaFNoYWRlcihwcm9ncmFtLCBmcyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g44K344Kn44O844OA44KS44Oq44Oz44KvXHJcbiAgICAgICAgZ2wubGlua1Byb2dyYW0ocHJvZ3JhbSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g44K344Kn44O844OA44Gu44Oq44Oz44Kv44GM5q2j44GX44GP6KGM44Gq44KP44KM44Gf44GL44OB44Kn44OD44KvXHJcbiAgICAgICAgaWYoZ2wuZ2V0UHJvZ3JhbVBhcmFtZXRlcihwcm9ncmFtLCBnbC5MSU5LX1NUQVRVUykpe1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAvLyDmiJDlip/jgZfjgabjgYTjgZ/jgonjg5fjg63jgrDjg6njg6Djgqrjg5bjgrjjgqfjgq/jg4jjgpLmnInlirnjgavjgZnjgotcclxuICAgICAgICAgICAgZ2wudXNlUHJvZ3JhbShwcm9ncmFtKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOODl+ODreOCsOODqeODoOOCquODluOCuOOCp+OCr+ODiOOCkui/lOOBl+OBpue1guS6hlxyXG4gICAgICAgICAgICByZXR1cm4gcHJvZ3JhbTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOWkseaVl+OBl+OBpuOBhOOBn+OCieOCqOODqeODvOODreOCsOOCkuOCouODqeODvOODiOOBmeOCi1xyXG4gICAgICAgICAgICBhbGVydChnbC5nZXRQcm9ncmFtSW5mb0xvZyhwcm9ncmFtKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBWQk/jgpLnlJ/miJDjgZnjgovplqLmlbBcclxuICAgIGZ1bmN0aW9uIGNyZWF0ZV92Ym8oZGF0YSl7XHJcbiAgICAgICAgLy8g44OQ44OD44OV44Kh44Kq44OW44K444Kn44Kv44OI44Gu55Sf5oiQXHJcbiAgICAgICAgdmFyIHZibyA9IGdsLmNyZWF0ZUJ1ZmZlcigpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOODkOODg+ODleOCoeOCkuODkOOCpOODs+ODieOBmeOCi1xyXG4gICAgICAgIGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCB2Ym8pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOODkOODg+ODleOCoeOBq+ODh+ODvOOCv+OCkuOCu+ODg+ODiFxyXG4gICAgICAgIGdsLmJ1ZmZlckRhdGEoZ2wuQVJSQVlfQlVGRkVSLCBuZXcgRmxvYXQzMkFycmF5KGRhdGEpLCBnbC5TVEFUSUNfRFJBVyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g44OQ44OD44OV44Kh44Gu44OQ44Kk44Oz44OJ44KS54Sh5Yq55YyWXHJcbiAgICAgICAgZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIG51bGwpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOeUn+aIkOOBl+OBnyBWQk8g44KS6L+U44GX44Gm57WC5LqGXHJcbiAgICAgICAgcmV0dXJuIHZibztcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gVkJP44KS44OQ44Kk44Oz44OJ44GX55m76Yyy44GZ44KL6Zai5pWwXHJcbiAgICBmdW5jdGlvbiBzZXRfYXR0cmlidXRlKHZibywgYXR0TCwgYXR0Uyl7XHJcbiAgICAgICAgLy8g5byV5pWw44Go44GX44Gm5Y+X44GR5Y+W44Gj44Gf6YWN5YiX44KS5Yem55CG44GZ44KLXHJcbiAgICAgICAgZm9yKHZhciBpIGluIHZibyl7XHJcbiAgICAgICAgICAgIC8vIOODkOODg+ODleOCoeOCkuODkOOCpOODs+ODieOBmeOCi1xyXG4gICAgICAgICAgICBnbC5iaW5kQnVmZmVyKGdsLkFSUkFZX0JVRkZFUiwgdmJvW2ldKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIGF0dHJpYnV0ZUxvY2F0aW9u44KS5pyJ5Yq544Gr44GZ44KLXHJcbiAgICAgICAgICAgIGdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KGF0dExbaV0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gYXR0cmlidXRlTG9jYXRpb27jgpLpgJrnn6XjgZfnmbvpjLLjgZnjgotcclxuICAgICAgICAgICAgZ2wudmVydGV4QXR0cmliUG9pbnRlcihhdHRMW2ldLCBhdHRTW2ldLCBnbC5GTE9BVCwgZmFsc2UsIDAsIDApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSUJP44KS55Sf5oiQ44GZ44KL6Zai5pWwXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVfaWJvKGRhdGEpe1xyXG4gICAgICAgIC8vIOODkOODg+ODleOCoeOCquODluOCuOOCp+OCr+ODiOOBrueUn+aIkFxyXG4gICAgICAgIHZhciBpYm8gPSBnbC5jcmVhdGVCdWZmZXIoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDjg5Djg4Pjg5XjgqHjgpLjg5DjgqTjg7Pjg4njgZnjgotcclxuICAgICAgICBnbC5iaW5kQnVmZmVyKGdsLkVMRU1FTlRfQVJSQVlfQlVGRkVSLCBpYm8pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOODkOODg+ODleOCoeOBq+ODh+ODvOOCv+OCkuOCu+ODg+ODiFxyXG4gICAgICAgIGdsLmJ1ZmZlckRhdGEoZ2wuRUxFTUVOVF9BUlJBWV9CVUZGRVIsIG5ldyBJbnQxNkFycmF5KGRhdGEpLCBnbC5TVEFUSUNfRFJBVyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g44OQ44OD44OV44Kh44Gu44OQ44Kk44Oz44OJ44KS54Sh5Yq55YyWXHJcbiAgICAgICAgZ2wuYmluZEJ1ZmZlcihnbC5FTEVNRU5UX0FSUkFZX0JVRkZFUiwgbnVsbCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g55Sf5oiQ44GX44GfSUJP44KS6L+U44GX44Gm57WC5LqGXHJcbiAgICAgICAgcmV0dXJuIGlibztcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8g44OG44Kv44K544OB44Oj44KS55Sf5oiQ44GZ44KL6Zai5pWwXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVfdGV4dHVyZShzb3VyY2Upe1xyXG4gICAgICAgIC8vIOOCpOODoeODvOOCuOOCquODluOCuOOCp+OCr+ODiOOBrueUn+aIkFxyXG4gICAgICAgIHZhciBpbWcgPSBuZXcgSW1hZ2UoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDjg4fjg7zjgr/jga7jgqrjg7Pjg63jg7zjg4njgpLjg4jjg6rjgqzjg7zjgavjgZnjgotcclxuICAgICAgICBpbWcub25sb2FkID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgLy8g44OG44Kv44K544OB44Oj44Kq44OW44K444Kn44Kv44OI44Gu55Sf5oiQXHJcbiAgICAgICAgICAgIHZhciB0ZXggPSBnbC5jcmVhdGVUZXh0dXJlKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDjg4bjgq/jgrnjg4Hjg6PjgpLjg5DjgqTjg7Pjg4njgZnjgotcclxuICAgICAgICAgICAgZ2wuYmluZFRleHR1cmUoZ2wuVEVYVFVSRV8yRCwgdGV4KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOODhuOCr+OCueODgeODo+OBuOOCpOODoeODvOOCuOOCkumBqeeUqFxyXG4gICAgICAgICAgICBnbC50ZXhJbWFnZTJEKGdsLlRFWFRVUkVfMkQsIDAsIGdsLlJHQkEsIGdsLlJHQkEsIGdsLlVOU0lHTkVEX0JZVEUsIGltZyk7XHJcbiAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELGdsLlRFWFRVUkVfTUFHX0ZJTFRFUixnbC5MSU5FQVIpO1xyXG4gICAgICAgIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCxnbC5URVhUVVJFX01JTl9GSUxURVIsZ2wuTElORUFSKTtcclxuICAgICAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsZ2wuVEVYVFVSRV9XUkFQX1MsZ2wuQ0xBTVBfVE9fRURHRSk7XHJcbiAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELGdsLlRFWFRVUkVfV1JBUF9ULGdsLkNMQU1QX1RPX0VER0UpO1xyXG5cclxuXHJcbiAgICAgICAgICAgIC8vIOODn+ODg+ODl+ODnuODg+ODl+OCkueUn+aIkFxyXG4gICAgICAgICAgICBnbC5nZW5lcmF0ZU1pcG1hcChnbC5URVhUVVJFXzJEKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOODhuOCr+OCueODgeODo+OBruODkOOCpOODs+ODieOCkueEoeWKueWMllxyXG4gICAgICAgICAgICBnbC5iaW5kVGV4dHVyZShnbC5URVhUVVJFXzJELCBudWxsKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOeUn+aIkOOBl+OBn+ODhuOCr+OCueODgeODo+OCkuOCsOODreODvOODkOODq+WkieaVsOOBq+S7o+WFpVxyXG4gICAgICAgICAgICB0ZXh0dXJlID0gdGV4O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g44Kk44Oh44O844K444Kq44OW44K444Kn44Kv44OI44Gu44K944O844K544KS5oyH5a6aXHJcbiAgICAgICAgaW1nLnNyYyA9IHNvdXJjZTtcclxuICAgIH1cclxuICAgIFxyXG59OyJdfQ==
