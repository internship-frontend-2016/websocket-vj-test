!function e(t,r,i){function n(o,E){if(!r[o]){if(!t[o]){var f="function"==typeof require&&require;if(!E&&f)return f(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var T=r[o]={exports:{}};t[o][0].call(T.exports,function(e){var r=t[o][1][e];return n(r?r:e)},T,T.exports,e,t,r,i)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)n(i[o]);return n}({1:[function(e,t,r){"use strict";function i(e){49==e.keyCode?S=1:50==e.keyCode?S=2:51==e.keyCode&&(S=3,g(h,"../img/logo.png")),37==e.keyCode?(M=!0,y--):39==e.keyCode?(M=!0,y++):38==e.keyCode?(M=!0,p++):40==e.keyCode?(M=!0,p--):M=!1,M&&(X+=.02),X>=30&&(X=30)}function n(e){M=!1}function a(e){I=e.offsetX/x,D=e.offsetY/B}function o(e,t,r){var i=L(e,l(e,t),l(e,r)),n=[];n[0]=e.getUniformLocation(i,"time"),n[1]=e.getUniformLocation(i,"mouse"),n[2]=e.getUniformLocation(i,"iResolution"),n[3]=e.getUniformLocation(i,"hsv");var a=[-1,1,0,1,1,0,-1,-1,0,1,-1,0],o=[0,2,1,1,2,3],E=A(e,a),f=U(e,o),u=e.getAttribLocation(i,"position");return{prg:i,uniLocation:n,vPosition:E,vIndex:f,attLocation:u}}function E(e){var t=sphere(64,64,1,[1,1,1,1]),r=A(e,t.p),i=A(e,t.c),n=A(e,t.t),a=[r,i,n],o=U(e,t.i);return{VBOList:a,iIndex:o,index:t.i}}function f(e,t,r){var i=L(e,l(e,t),l(e,r)),n=[];n[0]=e.getAttribLocation(i,"position"),n[1]=e.getAttribLocation(i,"texCoord");var a=new Array;a[0]=3,a[1]=2;var o=[];o[0]=e.getUniformLocation(i,"mvpMatrix"),o[1]=e.getUniformLocation(i,"texture"),o[2]=e.getUniformLocation(i,"strength"),o[3]=e.getUniformLocation(i,"width"),o[4]=e.getUniformLocation(i,"height");var E=[-1,1,0,1,1,0,-1,-1,0,1,-1,0],f=[0,0,1,0,0,1,1,1],u=[0,2,1,2,3,1],T=A(e,E),R=A(e,f),c=[T,R],d=U(e,u);return{prg:i,attLocation:n,attStride:a,uniLocation:o,VBOList:c,index:u,iIndex:d}}function u(e){var t=L(e,l(e,"vs"),l(e,"fs")),r=[];r[0]=e.getAttribLocation(t,"position"),r[1]=e.getAttribLocation(t,"color"),r[2]=e.getAttribLocation(t,"textureCoord");var i=[];i[0]=3,i[1]=4,i[2]=2;var n=[-1,1,0,1,1,0,-1,-1,0,1,-1,0],a=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],o=[0,0,1,0,0,1,1,1],E=[0,1,2,3,2,1],f=A(e,n),u=A(e,a),T=A(e,o),R=[f,u,T],c=U(e,E),d=[];return d[0]=e.getUniformLocation(t,"mvpMatrix"),d[1]=e.getUniformLocation(t,"texture"),{prg:t,attLocation:r,attStride:i,VBOList:R,iIndex:c,uniLocation:d}}function T(e,t,r,i,n,a,o,E,f){e.bindFramebuffer(e.FRAMEBUFFER,t.f),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),e.useProgram(r.prg),e.disable(e.BLEND),e.bindBuffer(e.ARRAY_BUFFER,r.vPosition),e.enableVertexAttribArray(r.vAttLocation),e.vertexAttribPointer(r.vAttLocation,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.vIndex),e.uniform1f(r.uniLocation[0],i),e.uniform2fv(r.uniLocation[1],[n,a]),e.uniform2fv(r.uniLocation[2],[o,E]),e.uniform4fv(r.uniLocation[3],[f[0],f[1],f[2],f[3]]),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function R(e,t,r,i,n,a){var o=new matIV,E=(o.identity(o.create()),o.identity(o.create())),f=o.identity(o.create()),u=o.identity(o.create());o.identity(o.create());e.useProgram(t.prg),e.clearColor(0,0,0,1),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),o.lookAt([0,0,.5],[0,0,0],[0,1,0],E),o.ortho(-1,1,1,-1,.1,1,f),o.multiply(f,E,u),a||(X-=.1,X<=0&&(X=0)),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,r.t),F(e,t.VBOList,t.attLocation,t.attStride),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.iIndex),e.uniformMatrix4fv(t.uniLocation[0],!1,u),e.uniform1i(t.uniLocation[1],0),e.uniform1f(t.uniLocation[2],X),e.uniform1f(t.uniLocation[3],i),e.uniform1f(t.uniLocation[4],n),e.drawElements(e.TRIANGLES,t.index.length,e.UNSIGNED_SHORT,0)}function c(e,t,r,i,n,a,o,E,f,u,T,R,c,d,l,L,A,U){if(e.clearColor(0,0,0,1),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.useProgram(t.prg),e.disable(e.BLEND),F(e,t.VBOList,t.attLocation,t.attStride),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.iIndex),i.identity(n),i.translate(n,[0,0,-95],n),i.scale(n,[100,70,1],n),i.multiply(a,n,o),e.bindTexture(e.TEXTURE_2D,r.t),e.uniform1i(t.uniLocation[1],0),e.uniformMatrix4fv(t.uniLocation[0],!1,o),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),e.enable(e.BLEND),f)for(var s=0;s<f.length;s++)c[s]-=.4,c[s]<-90&&(f.shift(),T.shift(),R.shift(),c.shift(),A--),_(e,i,n,a,o,t.uniLocation,s,T[s],R[s],c[s],!1);if(u)for(var s=0;s<u.length;s++)L[s]+=1,L[s]>10&&(u.shift(),d.shift(),l.shift(),L.shift(),U--),m(e,i,n,a,o,t.uniLocation,s,d[s],l[s],L[s],!1)}function d(e,t,r,i,n,a,o,E,f,u,T,R,c,d,l,L,A){var U=L%360*Math.PI/180,s=A%360*Math.PI/180,g=new matIV,v=g.identity(g.create()),I=g.identity(g.create()),D=g.identity(g.create()),x=g.identity(g.create()),B=g.identity(g.create()),h=[0,0,5],b=[0,1,0];g.perspective(45,e.width/e.height,.1,100,D),g.multiply(D,I,x);var N=new qtnIV,S=N.identity(N.create()),y=N.identity(N.create()),p=N.identity(N.create());N.rotate(U,[0,1,0],y),N.rotate(s,[1,0,0],p),N.multiply(p,y,S);var M=[],X=[];N.toVecIII(b,S,M),N.toVecIII([0,0,-1],S,X);var w=[];if(w[0]=h[0]+X[0],w[1]=h[1]+X[1],w[2]=h[2]+X[2],g.lookAt(h,w,M,I),g.multiply(D,I,x),t.bindFramebuffer(t.FRAMEBUFFER,r.f),t.clearColor(0,0,0,1),t.clearDepth(1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.useProgram(i.prg),t.disable(t.BLEND),F(t,n.VBOList,i.attLocation,i.attStride),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.iIndex),g.identity(v),g.translate(v,[0,0,5],v),g.scale(v,[10,10,10],v),g.rotate(v,180,[1,0,0],v),g.multiply(x,v,B),t.bindTexture(t.TEXTURE_2D,P),t.uniform1i(i.uniLocation[1],0),t.uniformMatrix4fv(i.uniLocation[0],!1,B),t.drawElements(t.TRIANGLES,n.index.length,t.UNSIGNED_SHORT,0),F(t,i.VBOList,i.attLocation,i.attStride),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i.iIndex),t.enable(t.BLEND),a)for(var O=0;O<a.length;O++)f[O]+=.1,u[O]<-90&&(a.shift(),E.shift(),f.shift(),u.shift(),d--),_(t,g,v,x,B,i.uniLocation,O,E[O],f[O],u[O],!0);if(o)for(var O=0;O<o.length;O++)c[O]+=1,c[O]>10&&(o.shift(),T.shift(),R.shift(),c.shift(),l--),m(t,g,v,x,B,i.uniLocation,O,T[O],R[O],c[O],!0);t.bindFramebuffer(t.FRAMEBUFFER,null)}function _(e,t,r,i,n,a,o,E,f,u,T){t.identity(r),t.translate(r,[E,f,u],r),T&&(t.rotate(r,Math.PI,[1,0,0],r),t.scale(r,[.3,.3,.3],r)),t.multiply(i,r,n),e.bindTexture(e.TEXTURE_2D,b[o]),e.uniform1i(a[1],0),e.uniformMatrix4fv(a[0],!1,n),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}function m(e,t,r,i,n,a,o,E,f,u,T){t.identity(r),t.translate(r,[E,f,u],r),T&&(t.rotate(r,Math.PI,[1,0,0],r),t.scale(r,[.3,.3,.3],r)),t.multiply(i,r,n),e.bindTexture(e.TEXTURE_2D,N[o]),e.uniform1i(a[1],0),e.uniformMatrix4fv(a[0],!1,n),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}function l(e,t){var r,i=document.getElementById(t);if(i){switch(i.type){case"x-shader/x-vertex":r=e.createShader(e.VERTEX_SHADER);break;case"x-shader/x-fragment":r=e.createShader(e.FRAGMENT_SHADER);break;default:return}return e.shaderSource(r,i.text),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)?r:void alert(e.getShaderInfoLog(r))}}function L(e,t,r){var i=e.createProgram();return e.attachShader(i,t),e.attachShader(i,r),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)?(e.useProgram(i),i):void alert(e.getProgramInfoLog(i))}function A(e,t){var r=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),r}function F(e,t,r,i){for(var n in t)e.bindBuffer(e.ARRAY_BUFFER,t[n]),e.enableVertexAttribArray(r[n]),e.vertexAttribPointer(r[n],i[n],e.FLOAT,!1,0,0)}function U(e,t){var r=e.createBuffer();return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Int16Array(t),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),r}function s(e,t,r,i){var n=new Image;n.onload=function(){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),i?N[r]=t:b[r]=t},n.src=t}function g(e,t){var r=new Image;r.onload=function(){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),P=t},r.src=t}function v(e,t,r){var i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i);var n=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,n),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t,r),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,n);var a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,r,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),{f:i,d:n,t:a}}var I,D,x,B,h,b=[],N=[],P=null,S=1,y=0,p=0,M=!1,X=0;window.resize=function(){x=window.innerWidth,B=window.innerHeight},window.onload=function(){var e=io(),t=document.getElementById("canvas");x=window.innerWidth,B=window.innerHeight,t.width=x,t.height=B,document.addEventListener("keydown",i),document.addEventListener("keyup",n),t.addEventListener("mousemove",a,!0),h=t.getContext("webgl")||t.getContext("experimental-webgl");var r=o(h,"tvs","tfs"),_=o(h,"tvs","intensiveFs"),m=E(h),l=f(h,"zoom.vs","zoom.fs"),L=u(h),A=new matIV,F=A.identity(A.create()),U=A.identity(A.create()),g=A.identity(A.create()),P=A.identity(A.create()),X=A.identity(A.create()),w=[0,0,5],O=[0,0,0],C=[0,1,0];A.lookAt(w,O,C,U),A.perspective(45,t.width/t.height,.1,100,g),A.multiply(g,U,P),h.enable(h.DEPTH_TEST),h.depthFunc(h.LEQUAL),h.activeTexture(h.TEXTURE0);var G=[],H=[],Y=[],V=[],k=[],W=[],j=0,q=0,z=!1;e.on("pushImageFromServer",function(e){1==e.frag?(z?s(h,"../img/joe.jpg",q,!0):s(h,e.imgdata,q,!0),V[q]=0,k[q]=0,W[q]=-95,q++):(z?s(h,"../img/joe.jpg",j,!1):s(h,e.imgdata,j,!1),G[j]=5*e.x,H[j]=5*e.y,Y[j]=0,j++),3==S&&(G[j]=5*e.x,H[j]=-5,Y[j]=5*e.y+5)}),e.on("pushJoFragFromServer",function(e){e.joFrag===!0&&(z=!0)}),e.emit("pushJoFragFromScreen",{joFrag:!1});var J=x,K=B,Q=v(h,J,K),Z=0,$=0;I=.5,D=.5;var ee=(new Date).getTime();h.blendFunc(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA),function te(){Z++,Z%10===0&&$++;var e=hsva($%360,1,1,1),i=Z%360*Math.PI/180,n=.001*((new Date).getTime()-ee);1==S?T(h,Q,r,n,I,D,x,B,e):2==S&&T(h,Q,_,n,I,D,x,B,e),1==S||2==S?c(h,L,Q,A,F,P,X,i,b,N,G,H,Y,V,k,W,j,q):3==S&&(d(t,h,Q,L,m,b,N,G,H,Y,V,k,W,j,q,y,p),R(h,l,Q,x,B,M)),h.flush(),requestAnimationFrame(te)}()}},{}]},{},[1]);