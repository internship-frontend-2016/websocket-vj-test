(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

var canvas;
var submitCanvas;
window.onload = function () {
	var socket = io();
	canvas = document.getElementById("myCanvas");
	submitCanvas = document.getElementById("submitCanvas");
	var subc = submitCanvas.getContext("2d");
	var c = canvas.getContext("2d");

	var w = 316;
	var h = 316;
	var drawing = false;
	var oldPos;

	canvas.width = w;
	canvas.height = h;

	//送信する側のキャンバス
	submitCanvas.width = w;
	submitCanvas.height = h;

	c.strokeStyle = "black";
	c.lineWidth = 5;
	c.lineJoin = "round";
	c.lineCap = "round";

	//タップ開始時に、絵を描く準備をする
	canvas.addEventListener("touchstart", function (e) {
		drawing = true;
		oldPos = getPosT(e, canvas);
	}, false);

	//タップ終了時に、絵を描く後処理を行う
	canvas.addEventListener("touched", function () {
		drawing = false;
	}, false);

	//gestureイベント（2本指以上触ると発生する）
	//終了時にも絵を描く後処理を行う
	canvas.addEventListener("gestureend", function () {
		console.log("mouseout");
		drawing = false;
	}, false);

	//実際に絵を書く処理
	//前回保存した位置から現在の位置に線を引く
	canvas.addEventListener("touchmove", function (e) {
		var pos = getPosT(e, canvas);
		if (drawing) {
			c.beginPath();
			c.moveTo(oldPos.x, oldPos.y);
			c.lineTo(pos.x, pos.y);
			c.stroke();
			c.closePath();
			oldPos = pos;
		}
	}, false);
	//色と線の太さを設定する
	setEventButtonColor("black", c);
	setEventButtonColor("blue", c);
	setEventButtonColor("red", c);
	setEventButtonColor("green", c);

	setEventLineWidth("small", c);
	setEventLineWidth("middle", c);
	setEventLineWidth("large", c);

	document.getElementById("delete_button").addEventListener("click", function () {
		c.clearRect(0, 0, $(canvas).width(), $(canvas).height());
	}, false);

	//ドキュメントのタッチイベントの初期化
	document.addEventListener("touchstart", stopDefault, false);
	document.addEventListener("touchmove", stopDefault, false);
	//document.addEventListener("touchend",stopDefault,false);
	//ドキュメントのジェスチャーイベントの初期化
	document.addEventListener("gesturestart", stopDefault, false);
	document.addEventListener("gesturechange", stopDefault, false);
	//document.addEventListener("gestureend",stopDefault,false);


	//画像をサーバーに送信する処理
	//var toImage=document.getElementById("toImage_AppearBack");
	document.getElementById("toImage_AppearBack").addEventListener("click", function () {
		var image = createbase64();
		console.log(image);
		socket.emit("pushImageFromClient", {
			imgdata: image,
			AppearBack: true
		});
	}, false);
	document.getElementById("toImage_DropFromUp").addEventListener("click", function () {
		var image = createbase64();
		console.log(image);
		socket.emit("pushImageFromClient", {
			imgdata: image,
			DropFromUp: true
		});
	}, false);

	var subPos;
	var normalPosX, normalPosY;
	var image;
	var sentFlag;
	var sendingTimer;
	/*-------------画像を送信する--------------*/

	submitCanvas.addEventListener("touchstart", function (e) {
		sentFlag = true;
		subPos = getPosT(e, submitCanvas);
		normalPosX = (subPos.x * 2 - w) / w;
		normalPosY = -((subPos.y * 2 - h) / h);
		image = createbase64();
		sendingTimer = setInterval(sentdata, 100);
	}, false);

	submitCanvas.addEventListener("touchmove", function (e) {
		//sentFlag=true;
		subPos = getPosT(e, submitCanvas);
		normalPosX = (subPos.x * 2 - w) / w;
		normalPosY = -((subPos.y * 2 - h) / h);
		image = createbase64();
	}, false);
	submitCanvas.addEventListener("touchend", function () {
		sentFlag = false;
		console.log("touchend");
		clearInterval(sendingTimer);
	}, false);

	function sentdata() {
		console.log("sentdata_function");

		socket.emit("pushImageFromClient", {
			imgdata: image,
			x: normalPosX,
			y: normalPosY
		});
	}
};
function createbase64() {
	var data = canvas.toDataURL("image/png");
	var imageContents = document.getElementById("imageContents");
	imageContents.innerHTML = "<img src='" + data + "'>";
	return data;
}
//タップ関連関数
function scrollX() {
	return document.documentElement.scrollLeft || document.body.scrollLeft;
}
function scrollY() {
	return document.documentElement.scrollTop || document.body.scrollTop;
}
function getPosT(_e, _canvas) {
	var mouseX = _e.touches[0].clientX - $(_canvas).position().left + scrollX();
	var mouseY = _e.touches[0].clientY - $(_canvas).position().top + scrollY();
	return { x: mouseX, y: mouseY };
}
function setEventButtonColor(_id, _c) {
	console.log(_id);
	document.getElementById(_id).addEventListener("click", function () {
		console.log(_id);
		_c.strokeStyle = _id;
	}, false);
}

function setEventLineWidth(_id, _c) {
	document.getElementById(_id).addEventListener("click", function () {
		console.log(_id + "_click");
		var strokewidth;
		switch (_id) {
			case "small":
				strokewidth = 5;
				break;
			case "middle":
				strokewidth = 10;
				break;
			case "large":
				strokewidth = 20;
				break;
			default:
				break;
		}
		console.log(strokewidth);
		_c.lineWidth = strokewidth;
	}, false);
}

//ブラウザのデフォルト動作を禁止する
function stopDefault(e) {
	if (e.touches[0].target.tagName.toLowerCase() == "li") {
		//console.log(e.touches[0].target.tagName.toLowerCase());
		return;
	}
	if (e.touches[0].target.tagName.toLowerCase() == "div") {
		return;
	}
	if (e.touches[0].target.tagName.toLowerCase() == "input") {
		return;
	}
	e.preventDefault();
}

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmNcXGpzXFxzbWFydHBob25lUGFpbnRBcHAuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLElBQUksTUFBSjtBQUNBLElBQUksWUFBSjtBQUNBLE9BQU8sTUFBUCxHQUFjLFlBQVU7QUFDdkIsS0FBSSxTQUFPLElBQVg7QUFDQSxVQUFPLFNBQVMsY0FBVCxDQUF3QixVQUF4QixDQUFQO0FBQ0EsZ0JBQWEsU0FBUyxjQUFULENBQXdCLGNBQXhCLENBQWI7QUFDQSxLQUFJLE9BQUssYUFBYSxVQUFiLENBQXdCLElBQXhCLENBQVQ7QUFDQSxLQUFJLElBQUUsT0FBTyxVQUFQLENBQWtCLElBQWxCLENBQU47O0FBRUEsS0FBSSxJQUFFLEdBQU47QUFDQSxLQUFJLElBQUUsR0FBTjtBQUNBLEtBQUksVUFBUSxLQUFaO0FBQ0EsS0FBSSxNQUFKOztBQUVBLFFBQU8sS0FBUCxHQUFhLENBQWI7QUFDQSxRQUFPLE1BQVAsR0FBYyxDQUFkOztBQUVBO0FBQ0EsY0FBYSxLQUFiLEdBQW1CLENBQW5CO0FBQ0EsY0FBYSxNQUFiLEdBQW9CLENBQXBCOztBQUVBLEdBQUUsV0FBRixHQUFjLE9BQWQ7QUFDQSxHQUFFLFNBQUYsR0FBWSxDQUFaO0FBQ0EsR0FBRSxRQUFGLEdBQVcsT0FBWDtBQUNBLEdBQUUsT0FBRixHQUFVLE9BQVY7O0FBRUE7QUFDQSxRQUFPLGdCQUFQLENBQXdCLFlBQXhCLEVBQXFDLFVBQVMsQ0FBVCxFQUFXO0FBQy9DLFlBQVEsSUFBUjtBQUNBLFdBQU8sUUFBUSxDQUFSLEVBQVUsTUFBVixDQUFQO0FBQ0EsRUFIRCxFQUdFLEtBSEY7O0FBS0E7QUFDQSxRQUFPLGdCQUFQLENBQXdCLFNBQXhCLEVBQWtDLFlBQVU7QUFDM0MsWUFBUSxLQUFSO0FBQ0EsRUFGRCxFQUVFLEtBRkY7O0FBSUE7QUFDQTtBQUNBLFFB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RUFBdUI7QUFDdEIsS0FBRyxFQUFFLE9BQUYsQ0FBVSxDQUFWLEVBQWEsTUFBYixDQUFvQixPQUFwQixDQUE0QixXQUE1QixNQUE2QyxJQUFoRCxFQUFxRDtBQUNwRDtBQUNBO0FBQ0E7QUFDRCxLQUFHLEVBQUUsT0FBRixDQUFVLENBQVYsRUFBYSxNQUFiLENBQW9CLE9BQXBCLENBQTRCLFdBQTVCLE1BQTJDLEtBQTlDLEVBQW9EO0FBQ25EO0FBQ0E7QUFDRCxLQUFHLEVBQUUsT0FBRixDQUFVLENBQVYsRUFBYSxNQUFiLENBQW9CLE9BQXBCLENBQTRCLFdBQTVCLE1BQTJDLE9BQTlDLEVBQXNEO0FBQ3JEO0FBQ0E7QUFDRCxHQUFFLGNBQUY7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJ2YXIgY2FudmFzO1xyXG52YXIgc3VibWl0Q2FudmFzO1xyXG53aW5kb3cub25sb2FkPWZ1bmN0aW9uKCl7XHJcblx0dmFyIHNvY2tldD1pbygpO1xyXG5cdGNhbnZhcz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm15Q2FudmFzXCIpO1xyXG5cdHN1Ym1pdENhbnZhcz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN1Ym1pdENhbnZhc1wiKTtcclxuXHR2YXIgc3ViYz1zdWJtaXRDYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG5cdHZhciBjPWNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcblxyXG5cdHZhciB3PTMxNjtcclxuXHR2YXIgaD0zMTY7XHJcblx0dmFyIGRyYXdpbmc9ZmFsc2U7XHJcblx0dmFyIG9sZFBvcztcclxuXHJcblx0Y2FudmFzLndpZHRoPXc7XHJcblx0Y2FudmFzLmhlaWdodD1oO1xyXG5cclxuXHQvL+mAgeS/oeOBmeOCi+WBtOOBruOCreODo+ODs+ODkOOCuVxyXG5cdHN1Ym1pdENhbnZhcy53aWR0aD13O1xyXG5cdHN1Ym1pdENhbnZhcy5oZWlnaHQ9aDtcclxuXHJcblx0Yy5zdHJva2VTdHlsZT1cImJsYWNrXCI7XHJcblx0Yy5saW5lV2lkdGg9NTtcclxuXHRjLmxpbmVKb2luPVwicm91bmRcIjtcclxuXHRjLmxpbmVDYXA9XCJyb3VuZFwiO1xyXG5cclxuXHQvL+OCv+ODg+ODl+mWi+Wni+aZguOBq+OAgee1teOCkuaPj+OBj+a6luWCmeOCkuOBmeOCi1xyXG5cdGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLGZ1bmN0aW9uKGUpe1xyXG5cdFx0ZHJhd2luZz10cnVlO1xyXG5cdFx0b2xkUG9zPWdldFBvc1QoZSxjYW52YXMpO1xyXG5cdH0sZmFsc2UpO1xyXG5cclxuXHQvL+OCv+ODg+ODl+e1guS6huaZguOBq+OAgee1teOCkuaPj+OBj+W+jOWHpueQhuOCkuihjOOBhlxyXG5cdGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlZFwiLGZ1bmN0aW9uKCl7XHJcblx0XHRkcmF3aW5nPWZhbHNlXHJcblx0fSxmYWxzZSk7XHJcblxyXG5cdC8vZ2VzdHVyZeOCpOODmeODs+ODiO+8iDLmnKzmjIfku6XkuIrop6bjgovjgajnmbrnlJ/jgZnjgovvvIlcclxuXHQvL+e1guS6huaZguOBq+OCgue1teOCkuaPj+OBj+W+jOWHpueQhuOCkuihjOOBhlxyXG5cdGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwiZ2VzdHVyZWVuZFwiLGZ1bmN0aW9uKCl7XHJcblx0XHRjb25zb2xlLmxvZyhcIm1vdXNlb3V0XCIpO1xyXG5cdFx0ZHJhd2luZz1mYWxzZTtcclxuXHR9LGZhbHNlKTtcclxuXHJcblx0Ly/lrp/pmpvjgavntbXjgpLmm7jjgY/lh6bnkIZcclxuXHQvL+WJjeWbnuS/neWtmOOBl+OBn+S9jee9ruOBi+OCieePvuWcqOOBruS9jee9ruOBq+e3muOCkuW8leOBj1xyXG5cdGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2htb3ZlXCIsZnVuY3Rpb24oZSl7XHJcblx0dmFyIHBvcyA9IGdldFBvc1QoZSxjYW52YXMpO1xyXG5cdFx0aWYoZHJhd2luZyl7XHJcblx0XHRcdGMuYmVnaW5QYXRoKCk7XHJcblx0XHRcdGMubW92ZVRvKG9sZFBvcy54LG9sZFBvcy55KTtcclxuXHRcdFx0Yy5saW5lVG8ocG9zLngscG9zLnkpO1xyXG5cdFx0XHRjLnN0cm9rZSgpO1xyXG5cdFx0XHRjLmNsb3NlUGF0aCgpO1xyXG5cdFx0XHRvbGRQb3M9cG9zO1xyXG5cdFx0fVxyXG5cdH0sZmFsc2UpO1xyXG5cdC8v6Imy44Go57ea44Gu5aSq44GV44KS6Kit5a6a44GZ44KLXHJcblx0c2V0RXZlbnRCdXR0b25Db2xvcihcImJsYWNrXCIsYyk7XHJcblx0c2V0RXZlbnRCdXR0b25Db2xvcihcImJsdWVcIixjKTtcclxuXHRzZXRFdmVudEJ1dHRvbkNvbG9yKFwicmVkXCIsYyk7XHJcblx0c2V0RXZlbnRCdXR0b25Db2xvcihcImdyZWVuXCIsYyk7XHJcblxyXG5cdHNldEV2ZW50TGluZVdpZHRoKFwic21hbGxcIixjKTtcclxuXHRzZXRFdmVudExpbmVXaWR0aChcIm1pZGRsZVwiLGMpO1xyXG5cdHNldEV2ZW50TGluZVdpZHRoKFwibGFyZ2VcIixjKTtcclxuXHJcblx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkZWxldGVfYnV0dG9uXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLGZ1bmN0aW9uKCl7XHJcblx0XHRjLmNsZWFyUmVjdCgwLDAsJChjYW52YXMpLndpZHRoKCksJChjYW52YXMpLmhlaWdodCgpKTtcdFx0XHJcblx0fSxmYWxzZSk7XHJcblxyXG5cdC8v44OJ44Kt44Ol44Oh44Oz44OI44Gu44K/44OD44OB44Kk44OZ44Oz44OI44Gu5Yid5pyf5YyWXHJcblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIixzdG9wRGVmYXVsdCxmYWxzZSk7XHJcblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLHN0b3BEZWZhdWx0LGZhbHNlKTtcclxuXHQvL2RvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLHN0b3BEZWZhdWx0LGZhbHNlKTtcclxuXHQvL+ODieOCreODpeODoeODs+ODiOOBruOCuOOCp+OCueODgeODo+ODvOOCpOODmeODs+ODiOOBruWIneacn+WMllxyXG5cdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJnZXN0dXJlc3RhcnRcIixzdG9wRGVmYXVsdCxmYWxzZSk7XHJcblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImdlc3R1cmVjaGFuZ2VcIixzdG9wRGVmYXVsdCxmYWxzZSk7XHJcblx0Ly9kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiZ2VzdHVyZWVuZFwiLHN0b3BEZWZhdWx0LGZhbHNlKTtcclxuXHJcblxyXG5cclxuXHQvL+eUu+WDj+OCkuOCteODvOODkOODvOOBq+mAgeS/oeOBmeOCi+WHpueQhlxyXG5cdC8vdmFyIHRvSW1hZ2U9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b0ltYWdlX0FwcGVhckJhY2tcIik7XHJcblx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b0ltYWdlX0FwcGVhckJhY2tcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsZnVuY3Rpb24oKXtcclxuXHRcdHZhciBpbWFnZT1jcmVhdGViYXNlNjQoKTtcclxuXHRcdGNvbnNvbGUubG9nKGltYWdlKTtcclxuXHRcdHNvY2tldC5lbWl0KFwicHVzaEltYWdlRnJvbUNsaWVudFwiLHtcclxuXHRcdFx0aW1nZGF0YTppbWFnZSxcclxuXHRcdFx0QXBwZWFyQmFjazp0cnVlXHJcblx0XHR9KTtcclxuXHR9LGZhbHNlKTtcclxuXHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvSW1hZ2VfRHJvcEZyb21VcFwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIixmdW5jdGlvbigpe1xyXG5cdFx0dmFyIGltYWdlPWNyZWF0ZWJhc2U2NCgpO1xyXG5cdFx0Y29uc29sZS5sb2coaW1hZ2UpO1xyXG5cdFx0c29ja2V0LmVtaXQoXCJwdXNoSW1hZ2VGcm9tQ2xpZW50XCIse1xyXG5cdFx0XHRpbWdkYXRhOmltYWdlLFxyXG5cdFx0XHREcm9wRnJvbVVwOnRydWVcclxuXHRcdH0pO1xyXG5cdH0sZmFsc2UpO1xyXG5cclxuXHR2YXIgc3ViUG9zO1xyXG5cdHZhciBub3JtYWxQb3NYLG5vcm1hbFBvc1k7XHJcblx0dmFyIGltYWdlO1xyXG5cdHZhciBzZW50RmxhZztcclxuXHR2YXIgc2VuZGluZ1RpbWVyO1xyXG5cdC8qLS0tLS0tLS0tLS0tLeeUu+WDj+OCkumAgeS/oeOBmeOCiy0tLS0tLS0tLS0tLS0tKi9cclxuXHJcblx0c3VibWl0Q2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsZnVuY3Rpb24oZSl7XHJcblx0XHRzZW50RmxhZz10cnVlO1xyXG5cdFx0c3ViUG9zPWdldFBvc1QoZSxzdWJtaXRDYW52YXMpO1xyXG5cdFx0bm9ybWFsUG9zWD0oc3ViUG9zLngqMi13KS93O1xyXG5cdFx0bm9ybWFsUG9zWT0tKChzdWJQb3MueSoyLWgpL2gpO1xyXG5cdFx0aW1hZ2U9Y3JlYXRlYmFzZTY0KCk7XHJcblx0c2VuZGluZ1RpbWVyPXNldEludGVydmFsKHNlbnRkYXRhLDEwMCk7XHJcblx0fSxmYWxzZSk7XHJcblxyXG5cdHN1Ym1pdENhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2htb3ZlXCIsZnVuY3Rpb24oZSl7XHJcblx0XHQvL3NlbnRGbGFnPXRydWU7XHJcblx0XHRzdWJQb3M9Z2V0UG9zVChlLHN1Ym1pdENhbnZhcyk7XHJcblx0XHRub3JtYWxQb3NYPShzdWJQb3MueCoyLXcpL3c7XHJcblx0XHRub3JtYWxQb3NZPS0oKHN1YlBvcy55KjItaCkvaCk7XHJcblx0XHRpbWFnZT1jcmVhdGViYXNlNjQoKTtcclxuXHR9LGZhbHNlKTtcclxuXHRzdWJtaXRDYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsZnVuY3Rpb24oKXtcclxuXHRcdHNlbnRGbGFnPWZhbHNlO1xyXG5cdFx0Y29uc29sZS5sb2coXCJ0b3VjaGVuZFwiKTtcclxuXHRcdGNsZWFySW50ZXJ2YWwoc2VuZGluZ1RpbWVyKTtcclxuXHR9LGZhbHNlKTtcclxuXHJcblx0ZnVuY3Rpb24gc2VudGRhdGEoKXtcclxuXHRcdGNvbnNvbGUubG9nKFwic2VudGRhdGFfZnVuY3Rpb25cIik7XHJcblx0XHRcclxuXHRcdHNvY2tldC5lbWl0KFwicHVzaEltYWdlRnJvbUNsaWVudFwiLHtcclxuXHRcdFx0aW1nZGF0YTppbWFnZSxcclxuXHRcdFx0eDpub3JtYWxQb3NYLFxyXG5cdFx0XHR5Om5vcm1hbFBvc1lcclxuXHRcdH0pO1xyXG5cdFx0XHRcdFxyXG5cdH1cclxuXHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlYmFzZTY0KCl7XHJcblx0dmFyIGRhdGE9Y2FudmFzLnRvRGF0YVVSTChcImltYWdlL3BuZ1wiKTtcclxuXHR2YXIgaW1hZ2VDb250ZW50cz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImltYWdlQ29udGVudHNcIik7XHJcblx0aW1hZ2VDb250ZW50cy5pbm5lckhUTUw9XCI8aW1nIHNyYz0nXCIrZGF0YStcIic+XCI7XHRcclxuXHRyZXR1cm4gZGF0YTtcclxufVxyXG4vL+OCv+ODg+ODl+mWoumAo+mWouaVsFxyXG5mdW5jdGlvbiBzY3JvbGxYKCl7cmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0fHxkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7fVxyXG5mdW5jdGlvbiBzY3JvbGxZKCl7cmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3B8fGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wO31cclxuZnVuY3Rpb24gZ2V0UG9zVChfZSxfY2FudmFzKXtcclxuXHR2YXIgbW91c2VYPV9lLnRvdWNoZXNbMF0uY2xpZW50WC0kKF9jYW52YXMpLnBvc2l0aW9uKCkubGVmdCtzY3JvbGxYKCk7XHJcblx0dmFyIG1vdXNlWT1fZS50b3VjaGVzWzBdLmNsaWVudFktJChfY2FudmFzKS5wb3NpdGlvbigpLnRvcCtzY3JvbGxZKCk7XHJcblx0cmV0dXJuIHt4Om1vdXNlWCx5Om1vdXNlWX07XHJcbn1cclxuZnVuY3Rpb24gc2V0RXZlbnRCdXR0b25Db2xvcihfaWQsX2Mpe1xyXG5cdGNvbnNvbGUubG9nKF9pZCk7XHJcblx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoX2lkKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIixmdW5jdGlvbigpe1xyXG5cdFx0Y29uc29sZS5sb2coX2lkKTtcclxuXHRcdF9jLnN0cm9rZVN0eWxlPV9pZDtcclxuXHR9LGZhbHNlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0RXZlbnRMaW5lV2lkdGgoX2lkLF9jKXtcclxuXHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChfaWQpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLGZ1bmN0aW9uKCl7XHJcblx0XHRjb25zb2xlLmxvZyhfaWQrXCJfY2xpY2tcIik7XHJcblx0XHR2YXIgc3Ryb2tld2lkdGg7XHJcblx0XHRzd2l0Y2goX2lkKXtcclxuXHRcdFx0Y2FzZSBcInNtYWxsXCI6XHJcblx0XHRcdFx0c3Ryb2tld2lkdGg9NTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSBcIm1pZGRsZVwiOlxyXG5cdFx0XHRcdHN0cm9rZXdpZHRoPTEwO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIFwibGFyZ2VcIjpcclxuXHRcdFx0XHRzdHJva2V3aWR0aD0yMDtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0ZGVmYXVsdDpcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdH1cclxuXHRcdGNvbnNvbGUubG9nKHN0cm9rZXdpZHRoKTtcclxuXHRcdF9jLmxpbmVXaWR0aD1zdHJva2V3aWR0aDtcclxuXHR9LGZhbHNlKTtcclxufVxyXG5cclxuLy/jg5bjg6njgqbjgrbjga7jg4fjg5Xjgqnjg6vjg4jli5XkvZzjgpLnpoHmraLjgZnjgotcclxuZnVuY3Rpb24gc3RvcERlZmF1bHQoZSl7XHJcblx0aWYoZS50b3VjaGVzWzBdLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT0gXCJsaVwiKXtcclxuXHRcdC8vY29uc29sZS5sb2coZS50b3VjaGVzWzBdLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCkpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHRpZihlLnRvdWNoZXNbMF0udGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKT09XCJkaXZcIil7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdGlmKGUudG91Y2hlc1swXS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpPT1cImlucHV0XCIpe1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHRlLnByZXZlbnREZWZhdWx0KCk7XHJcbn1cclxuIl19
